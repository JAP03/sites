PHTTP54.240.190.132"§
GET /ws-3.4.43_cc.js HTTP/1.1
 Host: scripts.webspectator.com
Connection: keep-alive
Accept: */*
vUser-Agent: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/31.0.1650.63 Safari/537.36
Referer: http://www.tmz.com/
$Accept-Encoding: gzip,deflate,sdch
!Accept-Language: en-US,en;q=0.8
*Cookie: webspectracking=2d8dc6dd45a9a652

*ѕж
HTTP/1.1 200 OK
&Content-Type: application/javascript
Content-Length: 111268
Connection: keep-alive
%Date: Wed, 18 Dec 2013 17:53:25 GMT
.Last-Modified: Wed, 18 Dec 2013 17:46:09 GMT
*ETag: "812d86bdda1c91a92a28b5abb578b2f7"
Accept-Ranges: bytes
Server: AmazonS3
Age: 24459
X-Cache: Hit from cloudfront
GVia: 1.1 1c618ea0f595386e66803b2a07e0f4dc.cloudfront.net (CloudFront)
GX-Amz-Cf-Id: PK7TcVagUGG2vchMRnOG5F5ztl9UF6jnL6aZdkb0SDDXFevW1Jxhng==
дт
/*
 WebSpectator 3.4.43 (174051.177)
*/
var JSON;
JSON||(JSON={},function(){function Z(f){return 10>f?"0"+f:f}function G(f){C.lastIndex=0;return C.test(f)?'"'+f.replace(C,function(f){var l=$[f];return"string"===typeof l?l:"\\u"+("0000"+f.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+f+'"'}function m(f,C){var x,s,X,$,ja=l,U,A=C[f];A&&("object"===typeof A&&"function"===typeof A.toJSON)&&(A=A.toJSON(f));"function"===typeof V&&(A=V.call(C,f,A));switch(typeof A){case "string":return G(A);case "number":return isFinite(A)?String(A):"null";case "boolean":case "null":return String(A);case "object":if(!A)return"null";
l+=D;U=[];if("[object Array]"===Object.prototype.toString.apply(A)){$=A.length;for(x=0;x<$;x+=1)U[x]=m(x,A)||"null";X=0===U.length?"[]":l?"[\n"+l+U.join(",\n"+l)+"\n"+ja+"]":"["+U.join(",")+"]";l=ja;return X}if(V&&"object"===typeof V){$=V.length;for(x=0;x<$;x+=1)"string"===typeof V[x]&&(s=V[x],(X=m(s,A))&&U.push(G(s)+(l?": ":":")+X))}else for(s in A)Object.prototype.hasOwnProperty.call(A,s)&&(X=m(s,A))&&U.push(G(s)+(l?": ":":")+X);X=0===U.length?"{}":l?"{\n"+l+U.join(",\n"+l)+"\n"+ja+"}":"{"+U.join(",")+
"}";l=ja;return X}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+Z(this.getUTCMonth()+1)+"-"+Z(this.getUTCDate())+"T"+Z(this.getUTCHours())+":"+Z(this.getUTCMinutes())+":"+Z(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var f=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
C=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,l,D,$={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},V;"function"!==typeof JSON.stringify&&(JSON.stringify=function(f,C,x){var s;D=l="";if("number"===typeof x)for(s=0;s<x;s+=1)D+=" ";else"string"===typeof x&&(D=x);if((V=C)&&"function"!==typeof C&&("object"!==typeof C||"number"!==typeof C.length))throw Error("JSON.stringify");return m("",{"":f})});
"function"!==typeof JSON.parse&&(JSON.parse=function(l,m){function C(f,l){var s,D,A=f[l];if(A&&"object"===typeof A)for(s in A)Object.prototype.hasOwnProperty.call(A,s)&&(D=C(A,s),void 0!==D?A[s]=D:delete A[s]);return m.call(f,l,A)}var s,l=String(l);f.lastIndex=0;f.test(l)&&(l=l.replace(f,function(f){return"\\u"+("0000"+f.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(l.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return s=eval("("+l+")"),"function"===typeof m?C({"":s},""):s;throw new SyntaxError("JSON.parse");})}());
(function(Z){function G(){this._events={};this._maxListeners=10}function m(f,m,l,D,G){this.type=f;this.listener=m;this.scope=l;this.once=D;this.instance=G}m.prototype.fire=function(f){this.listener.apply(this.scope||this,f);if(this.once)return this.instance.removeListener(this.type,this.listener),!1};G.prototype.eachListener=function(f,m){var l=null,D=null,G=null;if(this._events.hasOwnProperty(f)){D=this._events[f];for(l=0;l<D.length;l+=1)if(G=m.call(this,D[l],l),!1===G)l-=1;else if(!0===G)break}return this};
G.prototype.addListener=function(f,C,l,D){this._events.hasOwnProperty(f)||(this._events[f]=[]);this._events[f].push(new m(f,C,l,D,this));this.emit("newListener",f,C,l,D);this._maxListeners&&(!this._events[f].warned&&this._events[f].length>this._maxListeners)&&("undefined"!==typeof console&&console.warn("Possible EventEmitter memory leak detected. "+this._events[f].length+" listeners added. Use emitter.setMaxListeners() to increase limit."),this._events[f].warned=!0);return this};G.prototype.on=G.prototype.addListener;
G.prototype.once=function(f,m,l){return this.addListener(f,m,l,!0)};G.prototype.removeListener=function(f,m){this.eachListener(f,function(l,D){l.listener===m&&this._events[f].splice(D,1)});this._events[f]&&0===this._events[f].length&&delete this._events[f];return this};G.prototype.removeAllListeners=function(f){f&&this._events.hasOwnProperty(f)?delete this._events[f]:f||(this._events={});return this};G.prototype.listeners=function(f){if(this._events.hasOwnProperty(f)){var m=[];this.eachListener(f,
function(f){m.push(f.listener)});return m}return[]};G.prototype.emit=function(f){for(var m=[],l=null,l=1;l<arguments.length;l+=1)m.push(arguments[l]);this.eachListener(f,function(f){return f.fire(m)});return this};G.prototype.setMaxListeners=function(f){this._maxListeners=f;return this};Z.EventEmitter=G})(this);
window.WS||function(){var Z,G={version:"3.4.43"},m="undefined"!=typeof G?G:{version:"0.0.0"},f=m.core={},C=[],l,D,$,V,Oa,Pa,x=new function(){var a=new EventEmitter;a.setMaxListeners(50);this.listeners=function(b){return a.listeners(b)};this.listen=function(b,c,d){b||s("!invalid event name: '"+b+"'");a.addListener(b,c,d)};this.unlisten=function(b,c){a.removeListener(b,c)};this.emit=function(b){a.emit.apply(a,Array.prototype.slice.call(arguments,0))}},s=function(a,b){f.log(a,"core",b)},X=new function(a){a=
window[a];if(!a)throw Error("script parameters not found!");this.getParam=function(b,c,d,g){b=a[b];null==b?b=d:g&&(b="1"===b?!0:!1);return b};this.toString=function(){var a=[];if("undefined"!==typeof window._wsvars)for(i in window._wsvars)a.push(i+" : '"+window._wsvars[i]+"'");return a.sort().join("\n")}}("_wsvars");f.id=(+new Date+"").slice(-4);f.extendAPI=function(a){nb.extend(a)};var nb=new function(a,b){var c=a[b]={};this.extend=function(a){for(var b in a)c[b]=a[b]};this.getObject=function(){return c}}(window,
"WS");f.extension=new function(){var a={};this.make=function(b,c,d){var g=a[b];null==g&&(g=[],a[b]=g);g.push(c);return function(){var c=a[b],g=null,j=Array.prototype.slice.apply(arguments),k=j.length;j.push(null);for(var n=0;n<c.length;n++)g=c[n].apply(d?d:this,j),j[k]=g;return g}};this.add=function(b,c){a[b].push(c)}};f.zone=new function(a){var b={},c=function(a,b,c){this.constructor.prototype.init.apply(this,arguments)};c.prototype=new function(a){this.log=function(b){a.log(b,"zone '"+this.id+"'")};
this.init=a.extension.make("core.zone.init",function(b,c,d){this.id=b||c.getAttribute(a.globalParameters.attZoneId)||"";this.bannerId=a.util.trim(c.getAttribute(a.globalParameters.attBannerId)||"");this.element=c;this.options=d;this.log("initCore")});this.start=a.extension.make("core.zone.start",function(){this.log("startCore")});this.del=a.extension.make("core.zone.del",function(){this.log("deleted zone: "+this)});this.getData=a.extension.make("core.zone.getdata",function(){return{id:this.id,bannerId:this.bannerId}});
var b=a.extension.make("core.zone.tostring",function(a){var b={};b.id=a.id;b.bannerId=a.bannerId;return b});this.toString=function(){return JSON.stringify(b(this))}}(a);c.prototype.constructor=c;var d=function(d,B,p){d=a.util.trim(d);null!=b[d]?d=null:(d=new c(d,B,p),b[d.id]=d,d.start(),s("created zone: "+d.toString()));return d};this.getZone=function(a){return b[a]};this.eachZone=function(a,c){var d,j;for(j in b)if(d=a(b[j],j),"undefined"!=typeof d&&!1==d)break;c&&c()};this.deleteZone=function(a,
c){var d,c=c||{};return(d=c.zone)||(d=b[a])?(delete b[a],d.del(),!0):!1};this.createZone=function(a,b,c){return d(a,b,c)};this.clearZones=function(){for(var a in b)this.deleteZone(a,{zone:b[a]})};this.parseZones=function(){var b,c,p=0;s("parsing '"+f.globalParameters.zoneClassName+"' class for ad zone");c=document.getElementsByClassName(f.globalParameters.zoneClassName);for(var j=0,k=c.length;j<k;j++){b=c[j];var n=b.getAttribute(a.globalParameters.attZoneId);if("*"==Oa[0]||-1<Oa.indexOf(n)){if(0==
b.offsetHeight){var e=b.getAttribute("style")||"";b.setAttribute("style","float:left;"+e)}if("auto"==b.style.zIndex||"inherit"!=b.style.zIndex&&1>b.style.zIndex)b.style.zIndex=1;n&&d(n,b,{timeStamp:a.startTimeStamp})&&p++}}s("parseZones: created "+p+" zone(s)")};this.getPrototype=function(){return c.prototype};this.zones=function(){return b}}(f);f.events=new function(a,b){this.eventType={};this.listen=function(a,b,c){x.listen(a,b,c)};this.unlisten=function(a,b){x.unlisten(a,b)};this.emit=function(a,
b){x.emit.apply(x,Array.prototype.slice.call(arguments,0))};for(var c=this.eventType,d=0,g=b.length;d<g;d++)c[b[d]]=b[d]}(f,"viewportChanged scroll resize focus blur zoneIn zoneOut zoneInTentative bannerIn bannerOut bannerInTentative bannerPrint bannerResize frameLoaded campaignBannerPrint messageSent messageReceived messageChangeBanner instrumentationLoaded ortcConnected ortcDisconnected userIdle userActive click keypress keydown mousemove bannerGts zoneGts".split(" "));f.util=new function(a){this.scriptEvents=
{focusStatusChanged:"ws_focusStatusChanged",connectionStatusChanged:"ws_connectionStatusChanged",zoneStatusChanged:"ws_zoneStatusChanged",userStatusChanged:"ws_userStatusChanged",scriptStatusChanged:"ws_scriptStatusChanged"};this.DOM=new function(){var a=/px/,b=/rect\(((?:[0-9]*px\s?)*)\)/,c=function(b){b=b.replace(a,"");return""==b||"auto"==b?0:parseInt(b)};this.getElementCss=function(a){var b=null;a.currentStyle?b=a.currentStyle:window.getComputedStyle&&(b=document.defaultView.getComputedStyle(a,
null));return b};this.getElementSize=function(a){if(a.style&&a.style.clip){var d=a.style.clip.replace(/,/g,"").match(b);if(d)return d=d[1].split(" "),{w:c(d[1])-c(d[3]),h:c(d[2])-c(d[0]),l:c(d[3])+(c(a.style.left)||0),o:!1}}return{w:a.offsetWidth||c(this.getElementCss(a).width)||c(a.style.width),h:a.offsetHeight||c(this.getElementCss(a).height)||c(a.style.height),l:c(a.style.left)||0,o:!a.style.overflow||"visible"==a.style.overflow}};this.getElementWidth=function(a){return a.offsetWidth||c(this.getElementCss(a).width)||
c(a.style.width)};this.getElementHeight=function(a){return a.offsetHeight||c(this.getElementCss(a).height)||c(a.style.height)};this.documentHeight=function(){return Math.max(Math.max(document.body.scrollHeight,document.documentElement.scrollHeight),Math.max(document.body.offsetHeight,document.documentElement.offsetHeight),Math.max(document.body.clientHeight,document.documentElement.clientHeight))}};this.executeOnPredicate=function(a,b,c,p){var p=p||0,j=this;5<=p?s("executeOnPredicate: max tries reached ("+
p+") for function:"+a):b()?a():(p++,setTimeout(function(){j.executeOnPredicate.call(j,a,b,c,p)},c||1E3))};this.PartialTimer=function(){var a=0,b=0;this.start=function(c){a=c||+new Date;b=0};this.stop=function(c){if(0==a)return 0;b=c||+new Date;return b-a};this.on=function(){return 0<a};this.startTime=function(){return a};this.toJSON=function(){var c={};c.begin=a;c.end=b;c.elapsed=0==b?0:b-a;return c}};this.trim=function(a){return(a||"").replace(/^\s+|\s+$/g,"")};this.isArray=function(a){return a&&
"object"===typeof a&&"number"===typeof a.length&&"function"===typeof a.splice&&!a.propertyIsEnumerable("length")};this.ts=function(){var a=new Date;return""+a.getFullYear()+("0"+(a.getMonth()+1)).slice(-2)+("0"+a.getDate()).slice(-2)+" "+("0"+a.getHours()).slice(-2)+("0"+a.getMinutes()).slice(-2)+("0"+a.getSeconds()).slice(-2)+"."+("00"+a.getMilliseconds()).slice(-3)};var b;"undefined"===typeof console&&(window.console={tlog:"",log:function(){return!0}});this.logger={log:function(c,g){var B="("+a.id+
") ["+this.ts()+"] "+(g?"["+g+"] ":"")+c;b&&B.match(b)},filter:function(a){b=a?RegExp(a,"i"):!1}};this.log=this.logger.log;this.raiseEvent=function(a,b,c,p){b=b||{};b.id=f.id;b.index=Pa;c=!!c;p=!!p;if(document.createEvent){var j=document.createEvent("CustomEvent");j.initCustomEvent(a,c,p,b);document.dispatchEvent(j)}else if(document.name)for(func in document.name)document.name[func](b)};this.bindEvent=function(a,b,c){document.addEventListener?a.addEventListener(b,c):document.createEvent?a.attachEvent(b,
c):(a.name||(a.name=[]),a.name.push(c))};this.viewport=new function(){this.scrollTop=function(){var a;a=window.pageYOffset?window.pageYOffset:document.body.scrollTop?document.body.scrollTop:document.documentElement.scrollTop;"undefined"==typeof a&&(a=0);return a};this.scrollLeft=function(){var a;a=window.pageXOffset?window.pageXOffset:document.body.scrollLeft?document.body.scrollLeft:document.documentElement.scrollLeft;"undefined"==typeof a&&(a=0);return a};this.height=function(){return window.innerHeight||
document.documentElement.clientHeight||document.body.clientHeight};this.width=function(){return window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth}};this.cookies=new function(){this.createCookie=function(a,b,c){if(c){var p=new Date;p.setTime(p.getTime()+864E5*c);c="; expires="+p.toGMTString()}else c="";document.cookie=a+"="+b+c+(V?"; domain=."+V:"")+"; path=/"};this.readCookie=function(a){for(var a=a+"=",b=document.cookie.split(";"),c=0;c<b.length;c++){for(var p=b[c];" "==
p.charAt(0);)p=p.substring(1,p.length);if(0==p.indexOf(a))return p.substring(a.length,p.length)}return null};this.eraseCookie=function(a){this.createCookie(a,"",-1)}};var c=[];this.bind=function(a,b,B,p){p=p||{};p.prefix="undefined"!=typeof p.prefix?p.prefix:!0;document.addEventListener?a.addEventListener(b,B):a.attachEvent((p.prefix?"on":"")+b,B);p.auto&&c.push({t:a,e:b,cb:B})};this.unbindAll=function(){for(var a=c.length,b;a--;)b=c[a],b.t.detachEvent?b.t.detachEvent("on"+b.e,b.cb):b.t.removeEventListener(b.e,
b.cb)}}(f);f.register=function(a,b,c){m[a]=b;C.push(b);b.log=function(b,c){f.log(b,c||a)};for(var d in c)x.listen(d,c[d],m[a]);s("registered module: '"+a+"'")};f.getParam=function(a,b,c,d,g){a=X.getParam(a,b,c,d);s(b+":'"+a+"'",g);return a};f.log=function(a,b,c){(D||c)&&f.util.log(a,b)};f.mouseMoveHandler=new function(){this.lastMoveTimeStamp=this.y=this.x=this.ts=-1;this.update=function(a,b,c){var d=!1;this.ts=a;this.x!==b&&this.y!==c&&(this.lastMoveTimeStamp=this.ts,d=!0);this.x=b;this.y=c;return d}};
f.init=function(){l=m.instrumentation;f.util.bind(window,"scroll",function(){var a=0,b;return function(g){clearTimeout(b);s("scroll:"+ ++a);b=setTimeout(function(){x.emit("scroll",g)},200)}}(),{auto:!0});f.util.bind(window,"resize",function(){var a=0,b;return function(g){clearTimeout(b);s("resize:"+ ++a);b=setTimeout(function(){x.emit("resize",g)},200)}}(),{auto:!0});f.util.bind(window,"blur",function(){var a=0,b;return function(g){clearTimeout(b);s("blur:"+ ++a);b=setTimeout(function(){x.emit("blur",
g)},200)}}(),{auto:!0});f.util.bind(window,"focus",function(){var a=0,b;return function(g){clearTimeout(b);s("focus:"+ ++a);b=setTimeout(function(){x.emit("focus",g)},200)}}(),{auto:!0});f.globalParameters.trackIdleOn&&(f.util.bind(window,"keypress",function(a){x.emit("keypress",a)},{auto:!0}),f.util.bind(window,"keydown",function(a){x.emit("keydown",a)},{auto:!0}),f.util.bind(window,"mousemove",function(a){f.mouseMoveHandler.update(a.timeStamp,a.screenX,a.screenY)&&x.emit("mousemove",a)},{auto:!0}),
f.util.bind(document,"mousemove",function(a){f.mouseMoveHandler.update(a.timeStamp,a.screenX,a.screenY)&&x.emit("mousemove",a)},{auto:!0}),f.util.bind(window,"click",function(a){x.emit("click",a)},{auto:!0}));for(var a=0,b=C.length;a<b;a++)C[a].init&&C[a].init();$&&f.util.logger.filter($);f.startTimeStamp=+new Date;f.zone.parseZones(!0);a=0;for(b=C.length;a<b;a++)C[a].ready&&C[a].ready();f.util.raiseEvent(f.util.scriptEvents.scriptStatusChanged,{action:"ready"});s("init core")};f.isDebug=!1;f.reset=
function(){f.util.unbindAll();for(var a=0,b=C.length;a<b;a++)C[a].reset&&C[a].reset()};D=f.getParam("dbg","debugOn",!1,!0);f.globalParameters={};f.globalParameters.attZoneId="data-pid";f.globalParameters.attBannerId="data-bid";f.globalParameters.attBannerWidth="data-bannerWidth";f.globalParameters.attBannerHeight="data-bannerHeight";f.globalParameters.attCampaignId="data-cpid";f.globalParameters.attFirstPrint="data-cfp";f.globalParameters.attDisplayTime="data-dt";f.globalParameters.attImpressionId=
"data-iid";f.globalParameters.attRemnant="data-remnant";f.globalParameters.attTracker="data-tracker";f.globalParameters.attClose="data-close";f.globalParameters.attContentUrl="data-contenturl";f.globalParameters.sessionId=f.getParam("sessionId","sessionId","0");f.globalParameters.contextId=f.getParam("contextId","contextId","0");f.globalParameters.websiteId=f.getParam("wid","websiteId","");f.globalParameters.publicId=f.getParam("cid","publicId","");f.globalParameters.msgVersion=f.getParam("mve","messageVersion",
"");f.globalParameters.zoneClassName=f.getParam("zcn","zoneClassName","wsz");var ja=f.getParam("sfo","scriptInFrameOn",2);f.globalParameters.scriptInFrameOn=2==ja?window!=window.top:1==ja;f.globalParameters.trackIdleOn=f.globalParameters.scriptInFrameOn?!1:f.getParam("tio","trackIdleOn",!0,!0);$=f.getParam("lfe","logFilterExp","");f.InitOnLoad=f.getParam("iol","initOnLoad",!0,!0);f.InitOnPageLoad=f.getParam("ipl","initOnPageLoad",!1,!0);V=f.getParam("tld","topLevelDomain","");Oa=f.getParam("znl",
"zoneList","*").split(",");"undefined"==typeof document.getElementsByClassName&&(f.util.bind(window.document,"focusin",function(){var a=0,b;return function(c){clearTimeout(b);s("focus:"+ ++a);b=setTimeout(function(){x.emit("focus",c)},200)}}()),f.util.bind(window.document,"focusout",function(){var a=0,b;return function(c){clearTimeout(b);s("blur:"+ ++a);b=setTimeout(function(){x.emit("blur",c)},200)}}()));Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){for(var c=b||0,d=this.length;c<
d;c++)if(this[c]===a)return c;return-1});document.getElementsByClassName||(document.getElementsByClassName=function(a){for(var b=[],a=RegExp("\\b"+a+"\\b"),c,d=this.getElementsByTagName("*"),g=d.length;g--;)c=d[g],1==c.nodeType&&a.test(c.className)&&b.push(c);return b});Pa=(new function(){var a=window.WS_SCRIPTS||(window.WS_SCRIPTS=[]);this.add=function(b){a.push(b);return a.length-1};this.get=function(b){return a[b]}}).add(nb.getObject());f.extendAPI({id:f.id,version:m.version,index:Pa,init:function(){f.init()}});
var U=function(){D=!D;return"log "+(D?"on":"off")},A=function(a){if(a&&"?"===a[0])return"arguments: filter regex [string];";a=a?a[0]:null;f.util.logger.filter(a);return a?"set log filter to '"+a+"'":"clear log filter"},Ac=function(){alert(X.toString())},ob=function(){var a=0;s("dumping zones:");f.zone.eachZone(function(b){s(b.toString());a++;return!0});var b=a+" zones found";s(b);return b},Bc=function(){f.zone.clearZones();return"all zones deleted"},Cc=function(){f.zone.parseZones();ob();return"parsed zones"},
Dc=function(){alert(m.version)};f.events.listen(f.events.eventType.instrumentationLoaded,function(){l&&(l.addOper("log - toggle enabled",U),l.addOper("script - show params",Ac),l.addOper("zones - dump",ob),l.addOper("zones - clear",Bc),l.addOper("zones - parse",Cc),l.addOper("script - show version",Dc),l.addOper("log - set filter",A))});(function(a,b){var c={},d=a.core,g,B,p,j=function(a){eval("var ret = "+a);return ret},k=function(b){var c,d,g,k,B,p=[],e,f,h={};this.addOper=function(a,b){r(a,b)};
var m=function(a){if(""==a)return null;var c=RegExp(b.argumentsSeparator+b.argumentsSeparator,"g"),a=a.replace(RegExp(b.argumentsSeparator,"g"),"\ufffd"),a=a.replace(c,b.argumentsSeparator);return a.split("\ufffd")},l=function(a){for(var b=0;b<a.options.length;b++)if(a.options[b].selected)return a.options[b].value;return null},r=function(a,b){h[a]=b;var c;c=[];for(var d in h)c.push(d);c=c.sort(function(a,b){return a>=b?1:-1});f.innerHTML="";for(var g=0,k=c.length;g<k;g++)d=document.createElement("option"),
d.innerHTML=g+1+". "+c[g],d.value=c[g],f.appendChild(d)};this.exec=function(a,b){var c;if("."==a[0])switch(a.substring(1).toLowerCase()){case "h":this.showHistory()}else try{"undefined"!=typeof(c=j(a))&&this.msg(c),b&&p.push(a)}catch(d){this.msg(d,!0)}};this.exec2=function(a,b){var c;try{c=a(b),"undefined"===typeof c&&(c=""),this.msg(c)}catch(d){this.msg(d,!0)}};this.showHistory=function(){if(0==p.length)this.msg("history empty",!0);else{e=!0;var a;a=p.slice(0>p.length-10?0:p.length-10).reverse();
for(var b="<div style='padding:2px 2px 2px 2px;width:100%;text-align:center;font-weight:bold'>Command History:</div>",d=0;d<a.length;d++)b+="<span style='font-weight:solid'><b>"+d+"</b> - "+a[d]+"</span></br>";var g=document.createElement("div");g.setAttribute("style","border:2px solid;-moz-border-radius:5px; border-radius:5px;padding:5px 5px 5px 5px;position:fixed;bottom:0;width:300px;height:180px;color=#ff0000;background-color:#58D3F7;overflow:auto;opacity:1;z-index:9999");g.innerHTML=b;c.appendChild(g);
var j=c,B=this;window.onkeydown=function(b){if(!e)return!1;null==b&&(b=window.event);var c="undefined"!==typeof b.keyCode&&(null!=b.keyCode?b.keyCode:b.which);if(!(48<=c&&57>=c||27==c))return!1;b=!1;27==c?b=!0:(c=parseInt(String.fromCharCode(c)),c<a.length&&(k.value=a[c],b=!0));b&&(j.removeChild(g),B.cancelEvent());return e=!1}}};this.cancelEvent=function(){window.onkeydown=null};this.msg=function(a,b){var c=b?d:g;c.innerHTML="  "+a;setTimeout(function(){c.innerHTML=""},3E3)};this.show=function(){c.style.display=
"";B=!0};this.hide=function(){c.style.display="none";B=!1};this.toggle=function(){B?this.hide():this.show()};this.clear=function(){c.innerHTML=""};var t=this,q,u;u=b.barMinimal;c=document.createElement("div");c.innerHTML="<div style='vertical-align:middle;position: fixed;bottom:0;width: 100%;height:25px;background-color:#000000;overflow:none;opacity:1;z-index:2147483647'></div>";q=c.lastChild;u||(u=document.createElement("button"),u.style.fontSize="11px",u.style.margin=0,u.style.verticalAlign="baseline",
u.style.display="inline",u.innerHTML="close",u.onclick=function(){t.hide()},q.appendChild(u),u=document.createElement("button"),u.style.fontSize="11px",u.style.margin=0,u.style.verticalAlign="baseline",u.style.display="inline",u.innerHTML="clear",u.onclick=function(){k.value="";k.focus()},q.appendChild(u),k=document.createElement("input"),k.setAttribute("type","text"),k.style.fontSize="11px",k.style.margin=0,k.style.verticalAlign="baseline",k.style.display="inline",k.style.width="250px",k.onkeydown=
function(a){if(e)return!1;null==a&&(a=window.event);switch("undefined"!==typeof a.keyCode&&(null!=a.keyCode?a.keyCode:a.which)){case 13:t.exec(k.value,!0);break;case 220:"undefined"!==a.ctrlKey&&a.ctrlKey&&t.showHistory()}return!0},q.appendChild(k),u=document.createElement("input"),u.type="button",u.style.fontSize="11px",u.style.margin=0,u.style.verticalAlign="baseline",u.style.display="inline",u.value=">",u.onclick=function(){t.exec(k.value,!0)},q.appendChild(u));f=document.createElement("select");
f.style.fontSize="11px";f.style.margin=0;f.style.verticalAlign="baseline";f.style.display="inline";u=b.operations.slice(0);u.sort(function(a,b){var c,d,g;for(g in a)c=g.toLowerCase();for(g in b)d=g.toLowerCase();return c>d?1:-1});for(var s=0;s<u.length;s++)r(u[i]);q.appendChild(f);u=document.createElement("input");u.type="button";u.style.fontSize="11px";u.style.margin=0;u.style.verticalAlign="baseline";u.style.display="inline";u.value=">";u.onclick=function(){t.exec2(h[l(f)],m(k?k.value:""))};q.appendChild(u);
g=document.createElement("span");g.setAttribute("style","color:#ffffff;font-size:10px");q.appendChild(g);d=document.createElement("span");d.setAttribute("style","color:#ff0000;font-size:10px");q.appendChild(d);u=document.createElement("span");u.setAttribute("id","version");u.setAttribute("style","float:right;margin-right:5px;color:#ff0000;font-size:12px;align:right;valign:middle");u.innerHTML=a.version;q.appendChild(u);u=document.createElement("span");u.setAttribute("style","float:right;margin-right:5px;color:#FFFFFF;font-size:12px;align:right;valign:middle");
u.innerHTML="Status:<span id='scriptStatus'></span>";q.appendChild(u);c.appendChild(q);document.body&&document.body.appendChild(c);this.hide()};c.init=function(){B&&d.util.executeOnPredicate(function(){var a=d.getParam("itp","instrumentationTriggerPosition",4),b=d.getParam("ito","instrumentationVisibleOn",!1,!0),a=parseInt(a,10);if(1>a||4<a)a=4;g=new k({operations:[],argumentsSeparator:";",barMinimal:p});b&&g.show();b=document.createElement("div");b.setAttribute("id","ws_inst_trigger");b.onclick=
function(a){a=a||window.event;null!=a&&a.shiftKey&&g.toggle()};var c;if(null!=navigator.userAgent.match("iPad")){var j="";c=function(a){j+=a.keyCode-48;null!="57932".match(j)?(window.clearTimeout(void 0),"57932"==j?g.toggle():window.setTimeout(function(){j=""},1E3)):j=""};d.events.listen(d.events.eventType.keypress,c)}else{var B=!1;c=function(a){17==a.keyCode?B=!0:220==a.keyCode&&B&&g.toggle()};d.events.listen(d.events.eventType.keyup,function(a){17==a.keyCode&&(B=!1)});d.events.listen(d.events.eventType.keydown,
c)}b.setAttribute("style",["top:0","top:0;right:0","bottom:0;right:0","bottom:0"][a-1]+";padding:5px;position:fixed;width:5px;height:5px;background-color:#ff0000;opacity:0.0;filter: alpha(opacity = 0);z-index:2147483647");document.body&&document.body.appendChild(b);d.events.emit("instrumentationLoaded")},function(){return document.body});c.log("init instrumentation")};B=d.getParam("sio","scriptInstrumentationOn",!0,!0);p=d.getParam("ibm","instrumentationBarMinimal",!1,!0);c.addOper=function(a,b){g&&
g.addOper(a,b)};c.setStatus=function(a){var b=document.getElementById("scriptStatus");switch(a){case 1:b.innerHTML="Active";b.style.color="green";break;case 0:b.innerHTML="Inactive";b.style.color="red";break;case 2:b.innerHTML="Idle",b.style.color="orange"}};d.register(b,c,{})})(m,"instrumentation");var sa={},da=m.core,Aa=m.instrumentation,Qa,Ra,Ba={},Ec=function(a){return!a||!(1<=a.length&&2>=a.length)?"arguments: el id [string]; zone id [string]*":pb({domElement:document.getElementById(a[0]),id:a[1]||
a[0]})},Fc=function(a){return!a||1!=a.length?"arguments: el id [string];":qb({id:a[0]})},Gc=function(a){return!a||!(1<=a.length&&2>=a.length)?"arguments: el id [string]; categories list [string]*":rb({id:a[0],categories:a[1]||""})};da.events.listen(da.events.eventType.instrumentationLoaded,function(){Aa&&(Aa.addOper("zone - create",Ec),Aa.addOper("zone - delete",Fc),Aa.addOper("zone - categories hint",Gc))});var pb=function(a){var b=a.domElement,a=a.id;if(null==b)return sa.log("createAdZone: DOM element is null"),
!1;var c=a+"";if(null==a||""==a||""==(c=da.util.trim(c)))return sa.log("createAdZone: ID is null or empty"),!1;b=da.zone.createZone(c,b);Qa&&Qa.sendViewportState();return b},qb=function(a){a=a.id;return null==a?!1:da.zone.deleteZone(a)},rb=function(a){var b=a.id,a=a.categories,c;if(null==b)return!1;c=da.zone.getZone(b);return null!=c?(c.setCategories(b,a.split(",")),!0):!1};Ba.setLocationHint=function(a){var b=a.currentLocationHref,a=a.currentLocationHint;null!=b&&(Ra.currentLocationHref=b);null!=
a&&(Ra.currentLocationHint=a);return!0};Ba.Zones={create:function(a){return pb(a)},del:function(a){return qb(a)},setHint:function(a){return rb(a)}};Ba.Events={bind:function(a,b,c){da.util.bindEvent(a,b,c)}};sa.init=function(){Ra=m.analyticszones;Qa=m.tracking;sa.log("init api")};da.register("api",sa,{});da.extendAPI(Ba);var Y={},q=m.core,Ca=m.instrumentation,sb,tb,ma,ub,vb,wb,ta,xb,yb,zb,Sa,E=function(a){Y.log(a)},Q,Ab=function(a,b,c){E("Ortc: message received on channel '"+b+"':'"+c+"'");O&&O("messageReceived",
JSON.parse(c))},Cb=function(a,b,c){b=b||Bb;if(!na&&Sa)return E("Ortc: not connected. buffering message to resend: "+a),ua.push(a),O&&O("messageSent",{message:a,channel:b,sent:0}),!1;H&&(H.send(b,a.toString()),O&&(c=c||{},O("messageSent",{message:a,channel:b,sent:c.sent||1})));return!0},Db=function(){if(0==ua.length)E("Ortc: no buffered messages to resend");else{E("Ortc: resending buffered messages");for(var a,b=0;na&&0<(a=ua.splice(0,1)).length;)Cb(a[0],ga.outputChannel,{sent:2}),b++;E("Ortc: resent "+
b+" message(s)")}},Hc=function(){na=!0;E("Ortc: connected");for(var a=Ta.length,b=0;b<a;b++)Eb(Ta[b],Ab);H.setConnectionMetadata(Ua(++Va));Sa&&Db();"function"===typeof O&&O("connected",+new Date)},Eb=function(a,b){H.subscribe(a,!0,b);E("Ortc: subscribing to channel:'"+a+"'")},Ic=function(){na=!1;E("Ortc: disconnected");"function"===typeof O&&O("disconnected",+new Date)},Jc=function(a,b){E("Ortc: subscribed to channel:'"+b+"'")},Kc=function(a){E("Ortc: unsubscribed from channel:'"+a.channel+"'")},
Lc=function(a,b){E("Ortc: exception:'"+b+"'")},Fb=function(){E("Ortc: reconnected");H.setConnectionMetadata(Ua(++Va));na=!0;Db();O&&O("reconnected",+new Date)},Gb=function(){na=!1;E("Ortc: reconnecting");O&&O("reconnecting",+new Date)},na,H,ga,O,ua=[],Ta,Bb,Va=0,Wa,Xa,Ua=function(a){if("function"!=typeof O)return null;a=O("getConnMetadata",{connectionId:a}).toString();E("Ortc: connection metadata: "+a);return a};Q={init:function(a){ga=a;var b=ga.isCluster,c=ga.serverUrl;Wa=ga.authToken;Xa=ga.appKey;
Ta=ga.inputChannel;Bb=ga.outputChannel;var d=Ua(Va);loadOrtcFactory(IbtRealTimeSJType,function(a,B){if(null!=B)return E("Ortc: error connecting to ORTC"),!1;null!=a&&(H=a.createClient(),null!=d&&H.setConnectionMetadata(d),H.setId("client"),H.setConnectionTimeout(1E3),E("Ortc: connection timeout: 1000"),b?H.setClusterUrl(c):H.setUrl(c),H.onConnected=Hc,H.onSubscribed=Jc,H.onUnsubscribed=Kc,H.onException=Lc,H.onDisconnected=Ic,H.onReconnecting=Gb,H.onReconnected=Fb,H.connect(Xa,Wa))});return!0},setup:function(a){O=
a.listener},send:Cb,subscribe:function(a){if(a)for(var a="[object Array]"!==Object.prototype.toString.call(a)?[a]:a,b=0;b<a.length;b++)Eb(a[b],Ab)},reconnecting:Gb,reconnected:Fb,dumpBuffer:function(){for(var a=0,b=ua.length;a<b;a++)E(ua[a]);E(b+" message(s) buffered")},connect:function(){H.connect(Xa,Wa)},disconnect:function(){H.disconnect()},isConnected:function(){return H&&H.getIsConnected()},existsOrtcClient:function(){return null!=H}};var Hb=new function(a){var b=[],c=function(b){a.log("channelSubscriptionHelper: "+
b)},d=function(a){c("enqueuing "+JSON.stringify(a));b.push(a)};this.subscribe=function(a){Q.isConnected()?Q.subscribe(a):d({type:"s",ch:a})};this.unsubscribe=function(a){Q.isConnected()?Q.subscribe(a):d({type:"u",ch:a})};q.events.listen(q.events.eventType.ortcConnected,function(){var a,d,p;if(0==(d=a=b.length))c("queue empty");else{for(;a--;)p=b.shift(),"s"==p.type?Q.subscribe(p.ch):"u"==p.type&&Q.unsubscribe(p.ch);c("Finished processing queue with size "+d)}})}(Y),Mc=function(){Q.disconnect();return"ORTC disconnect..."},
Nc=function(){Q.connect();return"ORTC connect..."},Oc=function(){return"ORTC "+(Q.isConnected()?"":"not")+" connected"};q.events.listen(q.events.eventType.instrumentationLoaded,function(){Ca&&(Ca.addOper("ortc - disconnect",Mc),Ca.addOper("ortc - connect",Nc),Ca.addOper("ortc - isConnected",Oc))});tb=q.getParam("crt","connectOrtcOn",!0,!0);ma=q.getParam("uos","urlOrtcServer","").split(",");ma=ma[Math.floor(Math.random()*ma.length)];ub=q.getParam("oic","ortcIsCluster",!0,!0);ta=q.getParam("cip","channelInPrefix",
"");xb=q.getParam("cop","channelOutPrefix","");yb=q.getParam("aut","authToken","");Sa=q.getParam("rmo","resendMessagesOn",!0,!0);zb=q.getParam("apk","appKey","");var Ib=q.globalParameters.publisherChannelId=q.getParam("cid","publisherChannelId","");vb=ta+Ib;wb=xb+Ib;Y.sendMessage=function(a,b){Q.send(a,b)};Y.subscribeChannel=function(a){for(var a=q.util.isArray(a)?a:[a],b=a.length;b--;)Hb.subscribe(ta+a[b])};Y.unsubscribeChannel=function(a){for(var a=q.util.isArray(a)?a:[a],b=a.length;b--;)Hb.unsubscribe(ta+
a[b])};Y.init=function(){sb=m.messaging;setTimeout(Q.disconnect,18E5);var a={connected:function(a){E("Ortc listener: ortc connected");q.events.emit(q.events.eventType.ortcConnected,a)},reconnected:function(a){E("Ortc listener: reconnected");q.events.emit(q.events.eventType.ortcConnected,a)},reconnecting:function(a){E("Ortc listener: reconnecting");q.events.emit(q.events.eventType.ortcDisconnected,a)},disconnected:function(a){E("Ortc listener: disconnected");q.events.emit(q.events.eventType.ortcDisconnected,
a)},messageReceived:function(a){E("Ortc listener: messageReceived");E("message received: "+JSON.stringify(a));q.events.emit(q.events.eventType.messageReceived,a)},messageSent:function(a){Y.log("message sent: "+a.message);q.events.emit(q.events.eventType.messageSent,a)},getConnMetadata:q.extension.make("ortc.metadata",function(a){var c=sb.Message.create();c.addAction("cd");c.add(q.globalParameters.publicId);c.add(a.connectionId);c.addDebug(m.version||"0.0.0");return c})};Z=function(b,c){return a[b](c)};
Q.setup({listener:Z});tb&&(E("connecting to ORTC on url:'"+ma+"'"),q.util.executeOnPredicate(function(){q.util.raiseEvent(q.util.scriptEvents.connectionStatusChanged,{action:"connecting"});var a=[];a.push(vb);a.push(ta+q.globalParameters.sessionId+":"+q.globalParameters.contextId);Q.init({websiteId:q.globalParameters.websiteId,contextId:q.globalParameters.contextId,sessionId:q.globalParameters.sessionId,serverUrl:ma,isCluster:ub,inputChannel:a,outputChannel:wb,authToken:yb,appKey:zb})},function(){return!!window.loadOrtcFactory}));
Y.log("init ortc")};q.register("ortc",Y,{ortcConnected:function(a){Y.log("onOrtcConnected: "+a);q.util.raiseEvent(q.util.scriptEvents.connectionStatusChanged,{action:"connected"})},ortcDisconnected:function(a){Y.log("onOrtcDisconnected: "+a);q.util.raiseEvent(q.util.scriptEvents.connectionStatusChanged,{action:"disconnected"})}});var P={},J=m.core,ea,Da=m.instrumentation,Pc=J.globalParameters.msgVersion,Ea,Ya,Fa,va,Za,W,ka=new function(){var a=function(a){var c,d,g=[],B=[];this.add=function(a,b){b&&
(a=encodeURIComponent(a));g.push(a)};this.addAction=function(a){g[1]=a};this.field=function(a){var b="";switch(a){case "action":b=g[1];break;default:b=null}return b};this.addId=function(a){g[FIELD_ID]=a};this.addDebug=function(a,b){B.push(b?encodeURIComponent(a):a)};this.toString=function(){var a=g;1<B.length&&(a=a.concat(B));return a.join(c)};this.fieldSeparator="|";c=a.sep;d=a.debugPrefix;g[0]=a.version;g[1]=a.action;g[2]=a.websiteId;g[3]=a.sessionId;g[4]=a.contextId;B.push(d)};this.create=function(b){var b=
b||{},c={sep:"|",debugPrefix:"!!DBG:",id:"",action:""};c.version=Pc;c.websiteId=b.websiteId||J.globalParameters.websiteId;c.sessionId=J.globalParameters.sessionId;c.contextId=J.globalParameters.contextId;return new a(c)}},oa=function(a){return"undefined"==typeof a||null==a?!1:!0};P.sendMessage=function(a){if(ea)for(var a=J.util.isArray(a)?a:[a],b=0,c=a.length;b<c;b++)ea.sendMessage(a[b])};P.sendViewportState=function(a){if(ea&&oa(a.ts)&&oa(a.flag)){var b=ka.create();b.addAction("su");b.add(a.ts);
b.add(a.zoneIds);b.add(a.bannerIds);b.add(a.campaignIds);b.add(a.flag);b.add("undefined"!=typeof va?va:"");b.add(Ya);b.add(Fa);P.sendMessage(b)}};P.sendPostInitState=function(a){if(ea&&oa(a.ts)){var b=ka.create();b.addAction("pi");b.add(""+ +new Date);b.add(a.data);P.sendMessage(b)}};P.sendImpressionNotification=function(a){if(ea&&oa(a.bannerId)&&oa(a.zoneId)){var b=ka.create();b.addAction("bit");b.add(a.bannerId);b.add(a.zoneId);b.add(a.campaignId||"");P.sendMessage(b)}};P.sendGtsNotification=function(a){if(ea){var b=
ka.create();b.addAction(a.action);b.add(a.zoneId);b.add(a.bannerId);b.add(a.campaignId||"");P.sendMessage(b)}};P.sendTrackingZones=function(a){if(ea&&oa(a.trackingzoneIds)){var b=ka.create();b.addAction("wstz");b.add(a.trackingzoneIds);b.add(a.timestamp);b.add(a.screenWidth);b.add(a.currentLocationHint);b.add(a.focus);P.sendMessage(b)}};P.sendChangeBannerRequest=function(a){if(ea){var b=ka.create(a);b.addAction("cbreq");b.add(a.pid);b.add("undefined"!=typeof a.bannerId?a.bannerId:"");b.add("undefined"!=
typeof a.script?a.script:"");b.add("undefined"!=typeof a.mode?a.mode:"");b.add("undefined"!=typeof a.meta?a.meta:"");b.add("undefined"!=typeof a.state?a.state:"");b.add(Ya);b.add(Fa);b.add("undefined"!=typeof va?va:"");b.add("undefined"!=typeof Za?Za:"");a.cpid&&b.add(a.cpid);a.testdata&&b.add(JSON.stringify(a.testdata));P.sendMessage(b)}};P.Message=ka;P.init=function(){J=m.core;ea=m.ortc;Ea=J.getParam("plo","pageLoggerOn",!1,!0);Ya=J.getParam("ip","userIp","0.0.0.0",!1);va=J.getParam("country_code",
"country","",!1);Za=J.getParam("region","region","",!1);var a=navigator.userAgent;if(-1==a.indexOf("MSIE"))Fa=a;else{var b=a.match(/(Mozilla\/\d*\.\d*\s?\()(compatible;)?(\s?[\w\s\d\.\/]*;){0,2}(\s?[\w\s\d\.\/]*)/gmi);Fa=null==b||-1==a.indexOf("MSIE")?a:b[0]+")"}Ea&&J.util.executeOnPredicate(function(){Jb(!0)},function(){return document.body});P.log("init messaging")};var Qc=function(a){var b,c,d,g=1,B="",e=[];this.setFilter=function(a){B=a;for(var c in b.childNodes){var d=b.childNodes.item(c);d.style.display=
d.innerHTML.match(a)?"":"none"}};this.setOpacity=function(a){b.style.opacity=a};this.setBgColor=function(a){b.style.backgroundColor=a};this.setHeight=function(a){b.style.height=a+"px"};this.setFontSize=function(a){d=a};this.show=function(){b.style.display="";c=!0};this.hide=function(){b.style.display="none";c=!1};this.toggle=function(){c?this.hide():this.show();return c};this.clear=function(){b.innerHTML=""};this.addLineDecorator=function(a,b){e.push([RegExp(a,"g"),b])};this.write=function(a){if(c){var k=
document.createElement("div");k.setAttribute("style","text-align:left;z-index:2147483640;font-weight:bold;color:#ff0000;opacity:1.0;font-size:"+d+"px");for(var n='<span style="color:#0000ff">'+("000"+g++).slice(-3)+"</span> ",f=e.length,h=0;h<f;h++)a=a.replace(e[h][0],e[h][1]);k.innerHTML=n+a;k.innerHTML.match(B)||(k.style.display="none");0===b.childNodes.length?b.appendChild(k):b.insertBefore(k,b.childNodes.item(0));setTimeout(function(){k.style.color="#000000"},2E3)}};a=a||{};d=a.fontSize||11;a=
a.height||100;b=document.createElement("div");b.setAttribute("style","line-height: 13px;padding:5px;position: fixed;bottom:0;width: 99%;border: 0px solid black;height:"+a+"px;background-color:yellow;overflow:auto;opacity:0.8;z-index:2147483640");b.setAttribute("id","page-logger");document.body&&document.body.appendChild(b);this.hide()},Rc=function(a){W&&W.write((0==a.sent?"!":2==a.sent?"*":"")+"["+J.util.ts()+"] "+a.message)},Sc=function(a){W&&W.write("["+J.util.ts()+"] "+a.a+"|"+(a.d.zone||a.d.z)+
"|"+(a.d.state||"")+"|"+(a.d.content&&""!=a.d.content?"newbanner":"empty"))},Jb=function(a){J.events.listen(J.events.eventType.messageSent,Rc);J.events.listen(J.events.eventType.messageReceived,Sc);W=new Qc({height:150});a&&W.show()},Tc=function(){!W&&Jb();W.toggle()},Uc=function(){Ea&&W&&W.clear()},Vc=function(a){Ea&&W&&W.setFilter(a&&0<a.length?a[0]:"")};J.events.listen(J.events.eventType.instrumentationLoaded,function(){Da&&(Da.addOper("page log - filter",Vc),Da.addOper("page log - toggle enabled",
Tc),Da.addOper("page log - clear",Uc))});J.register("messaging",P,{});var w={},h=m.core,$a,S=m.instrumentation,la,pa=!1,Kb,ab,Lb,Ga,Mb,bb,M=!0,Nb,Ob,Pb,cb,Ha=!1,Ia,db=!1,K,Wc=function(){la=!la;return"focus "+(la?"on":"off")},Rb=function(a){pa=!pa;h.zone.eachZone(function(b){pa?Qb({zone:b,inspection:{top:b.top,left:b.left,width:b.width,height:b.height,verticalVisible:0,horizontalVisible:0,visibleArea:0,name:a?a[b.id]?a[b.id]:"INVALID":null}}):null!=b.overlay&&(b.overlay.del(),delete b.overlay);return!0});
return"zones overlay "+(pa?"on":"off")};w.toggleOverlay=Rb;var Xc=function(a){return!a||1!=a.length?"arguments: threshold secs [int]":"visibility threshold: "+parseInt(a[0],10)+" ms"},Yc=function(a){if(!a||1!=a.length)return"arguments: threshold % [int]";ab=a=parseInt(a[0],10);return"visibility threshold: "+a+" ms"},Zc=function(a){var b=a.id,c,d=document.createElement("UL"),g;this.addContent=function(){var a=document.createElement("DIV");a.id="overlay_"+b;a.setAttribute("style","font-size:14px;text-align:center;opacity:1;z-index:2147483647;background-color:lime;width:100%;min-height:25px;");
var e=document.createElement("BUTTON");e.innerHTML="Request Banner";e.setAttribute("style","float:right");e.onclick=function(){h.zone.getZone(b).nextBanner({bannerId:"-1"})};c=document.createElement("B");c.innerHTML="pid:"+b;c.setAttribute("style","float:left");a.appendChild(c);a.appendChild(e);g.appendChild(a);g.appendChild(d)};this.hide=function(){g.setAttribute("style","display:none")};this.del=function(){g&&g.parentNode.removeChild(g)};this.setVolatileColor=function(a){g.style.backgroundColor=
a};this.show=function(a){a.data.name&&(c.innerHTML=a.data.name+"(pid:"+b+")");"INVALID"==a.data.name&&(c.style.color="red");g.setAttribute("id","overlay_shell_"+b);g.setAttribute("style","display:'';border:3px solid lime; position:absolute;top:0px;left:0px;height:"+a.data.height+"px;width:"+a.data.width+"px;z-index:10000000;overflow:visible")};this.addEntry=function(a){var b=document.createElement("LI");b.style.margin="0px 0px";b.innerHTML=a.getHours()+":"+a.getMinutes()+":"+a.getSeconds();d.appendChild(b)};
this.init=function(){var a=document.createElement("DIV");a.setAttribute("class","wsOverlay");a.setAttribute("style","position:relative;height:0px;width:0px");var c=h.zone.getZone(b),d=c.element;d.insertBefore(a,d.firstChild);g=document.createElement("div");a.appendChild(g);c.overlayData=this;this.addContent();if(c.queue){a=c.queue.getData();for(c=0;c<a.length;c++)this.addEntry(new Date(parseInt(a[c].visibId.substring(0,a[c].visibId.length-3))))}};d.style.position="absolute";d.style.padding="0px";
d.style.backgroundColor="lime";d.style.bottom="0px";this.init(a)},Qb=function(a){var b=a.zone;pa&&(null==b.overlay&&(b.overlay=new Zc({id:b.id,data:a.inspection,opacity:0.5})),b.overlay.show({data:a.inspection,text:"<b>pid:"+b.id+"</b>"}))},$c=function(a){Qb(a)};h.events.listen(h.events.eventType.instrumentationLoaded,function(){S&&(S.addOper("zones - toggle overlay",Rb),S.addOper("focus - toggle enabled",Wc),S.addOper("zones - change visibility threshold",Xc),S.addOper("zones - change banner's area threshold",
Yc),h.events.listen(h.events.eventType.zoneInTentative,$c))});var Sb=function(a){for(var b=h.util.DOM.getElementSize(a),c=b.w,d=b.h,g=b.l,e=0,p=0;p<a.children.length&&b.o;p++)var j=Sb(a.children[p]),c=j.w>c?j.w:c,d=j.h>d?j.h:d,e=Math.abs(j.l)>Math.abs(e)?j.l:e;return{w:c,h:d,l:g+e}},Ub=function(a){var a=a||{},b=a.timeStamp||a.event?a.event.timeStamp||+new Date:+new Date,c={height:Lb,minAreaVisible:ab,top:a.top,left:a.left,id:this.id};if(this.wsOwner){if(this.frameBusted){var d=Sb(this.element.lastChild);
c.width=d.w;c.height=d.h;c.hDisplacement=d.l}else c.width=this.width,c.height=this.height;c.useDimensions=!0}c=Tb(this.element,c);a.reset&&(c.inViewport=!1);"undefined"!=typeof a.forceInViewport&&(c.inViewport=a.forceInViewport);this.left=c.left;this.top=c.top;this.width=c.width;this.height=c.height;d=this.currView;this.currView=c.inViewport&&M;a={inspectData:c,timeStamp:b,reset:a.reset};this.currView&&!d?this.intoView(a):!this.currView&&d&&this.outOfView(a);this.log((this.currView?"ON":"OFF")+" VIEW | (zone) t:"+
this.top+" l:"+this.left+" w:"+this.width+" h:"+this.height+(c.defaultHeight?"*":"")+" a:"+c.visibleArea+"% | (viewport): t:"+c.viewportTop+" r:"+c.viewportRight+" b:"+c.viewportBottom+" l:"+c.viewportLeft+" w:"+c.viewportWidth+" h:"+c.viewportHeight)},Tb=function(a,b){var c,d,g,e,p,j,k,n,f,N,m=0,l=0,q=0,r,t=b.minAreaVisible||100;j=h.util.viewport.scrollLeft();p=h.util.viewport.scrollTop();k=h.util.viewport.height();n=h.util.viewport.width();g=h.util.DOM.getElementCss(a);r="undefined"!==typeof a.style&&
("none"==g.display||"hidden"==g.visibility);if("undefined"!==typeof b.top&&"undefined"!==typeof b.left)c=b.top,d=b.left;else if(c=a.offsetTop,d=a.offsetLeft,g.position&&"fixed"==g.position)c+=p,d+=j;else{for(g=a;"HTML"!=g.nodeName&&g.offsetParent;){g=g.offsetParent;e=h.util.DOM.getElementCss(g);if(e.position&&"fixed"==e.position){c+=p+g.offsetTop;d+=j+g.offsetLeft;break}c+=g.offsetTop;d+=g.offsetLeft}for(g=a;"HTML"!=g.nodeName&&g.parentNode&&!(g=g.parentNode,e=h.util.DOM.getElementCss(g),r=r?r:e&&
("none"==e.display||"hidden"==e.visibility),e&&"fixed"==e.position););}d=b.hDisplacement?d+b.hDisplacement:d;b.useDimensions?(e=b.height||h.util.DOM.getElementHeight(a),g=b.width||h.util.DOM.getElementWidth(a)):(e=h.util.DOM.getElementHeight(a),g=h.util.DOM.getElementWidth(a));b.useDimensions&&b.height&&(e=parseInt(b.height));b.useDimensions&&b.width&&(g=parseInt(b.width));f=j+n;N=p+k;c>=p&&c+e<=N&&d>=j&&d+g<=f?q=100:c+e<p||c>N||d+g<j||d>f?q=0:(c>=p&&c+e<=N?m=e:c<p?m=c+e-p:c<N&&(m=N-c),d>=j&&d+g<=
f?l=g:d<j?l=d+g-j:d<f&&(l=f-d),q=Math.round(100*(m*l/(e*g))));return{top:c,left:d,width:g,height:e,defaultHeight:void 0,viewportTop:p,viewportRight:f,viewportBottom:N,viewportLeft:j,viewportWidth:n,viewportHeight:k,verticalVisible:m,horizontalVisible:l,visibleArea:q,inViewport:r?!1:q>=t?!0:!1}},ad=new function(){var a=!1,b=!0,c=window.attachEvent?!0:!1,d,g,e;this.isIdle=function(){return a};this.setIdle=function(a){j(a)};this.clear=function(){w.log("clear idle: "+e);clearTimeout(e)};var p=function(b,
c){Ha=a=b;S&&S.setStatus(Ha?2:1);h.events.emit(b?h.events.eventType.userIdle:h.events.eventType.userActive);b?(Ia&&h.util.cookies.createCookie("ws-idl","1",1),d?R({reset:!0}):c&&c.pingViewport&&Ja()):(Ia&&h.util.cookies.eraseCookie("ws-idl","",-1),d?R():Ja())},j=function(b){b=b||{};w.log("set idle with options: "+JSON.stringify(b));!a&&M&&(clearTimeout(e),p(!0,b))};this.signalActiveEvent=function(d){d=d||{};b&&"onmousemove"==d.eventName?b=!1:c&&"onfocus"==d.eventName?c=!1:(clearTimeout(e),e=setTimeout(function(){j({pingViewport:!0})},
g),a&&p(!1,d))};this.init=function(){g=h.getParam("tip","trackIdlePeriod",19);d=h.getParam("rvi","resetViewportOnIdle",!0,!0);g*=1E3;Ia&&h.util.cookies.readCookie("ws-idl")?j({pingViewport:!0}):e=setTimeout(function(){j({pingViewport:!0})},g)}}(w),Vb=new function(){var a=new function(){var a,c,d,g;this.zones=function(){return a};this.banners=function(){return c};this.campaigns=function(){return d};this.equals=function(a,b,c,d){return g==e(a,b,c,d)};this.update=function(p,j,k,n){a=j;c=k;d=n;g=e(p);
w.log("update viewstate to: "+g)};var e=function(g,e,k,n){return"z:"+(e||a.join())+"|b:"+(k||c.join())+"|c:"+(n||d.join())+"|f:"+g}};this.reset=function(){clearTimeout(bb);Ga=0};this.sendStatus=function(b){if(Kb){var b=b||{},c,d=[],g=[],e=[],f=!!b.ignoreViewport,j=Ha?2:M?1:0;if(Nb||!f){var k=h.zone.zones(),n;for(n in k)c=k[n],Ub.call(c,b),d.push(c.currView&&(c.fp||0<c.height)?c.id||"":""),g.push(c.currView&&(c.fp||0<c.height)?!cb&&c.remnant?"":c.bannerId||"":""),e.push(!cb&&c.remnant?"":c.campaignId||
"")}if(f||!a.equals(j,d,g,e))clearTimeout(bb),f||(a.update(j,d,g,e),w.log("viewportStateHelper: viewport changed: zones ("+d.length+"): "+d.join()+" banners ("+g.length+"): "+g.join())),$a&&$a.sendViewportState({ts:b.ts?b.ts:+new Date,zoneIds:2==j||0==j?"":a.zones(),bannerIds:2==j||0==j?"":a.banners(),campaignIds:a.campaigns(),flag:j}),Ga&&(bb=setTimeout(Ja,Ga))}}},R=Vb.sendStatus,Ja=function(){R({ignoreViewport:!0})},bd=function(){w.log("user idle");h.util.raiseEvent(h.util.scriptEvents.userStatusChanged,
{action:"idle"})},cd=function(){w.log("user active");h.util.raiseEvent(h.util.scriptEvents.userStatusChanged,{action:"active"})},dd=function(){K&&K.signalActiveEvent({eventName:"onmousemove",pingViewport:M})},ed=function(){K&&K.signalActiveEvent({eventName:"onkeypress",pingViewport:M})},fd=function(){K&&K.signalActiveEvent({eventName:"onkeydown",pingViewport:M})},gd=function(){K&&K.signalActiveEvent({eventName:"onclick",pingViewport:M})},hd=function(a){M&&R({event:a})},jd=function(a){M&&(K&&K.signalActiveEvent({eventName:"onscroll",
pingViewport:M}),R({event:a}))},kd=function(a){M&&(K&&K.signalActiveEvent({eventName:"onresize",pingViewport:M}),R({event:a}))},ld=function(a){if(la||!a)w.log((la?"":"!")+"focus"),db=M=!0,setTimeout(function(){db=!1},50),S&&S.setStatus(1),R({event:a}),a&&K&&K.signalActiveEvent({eventName:"onfocus",pingViewport:!1}),h.util.raiseEvent(h.util.scriptEvents.focusStatusChanged,{action:"focusin"})},md=function(a){la&&!db&&(w.log("blur"),M=!1,S&&S.setStatus(0),K&&K.signalActiveEvent({eventName:"onblur",pingViewport:!1}),
R({event:a,reset:!0}),K&&K.clear(),h.util.raiseEvent(h.util.scriptEvents.focusStatusChanged,{action:"focusout"}))},ba=function(a){return RegExp(a+"=(?:'|\")([^('|\")]*)(?:'|\")")},eb=function(a,b,c){var d=null,a=a.match(b);null!=a&&c<a.length&&(d=a[c]);return d},Wb,nd=ba(h.globalParameters.attFirstPrint);Wb=function(a){var b=a.element.outerHTML,c=/data-fp=['|"]1['|"]/;b&&null!=b.match(c)?(w.parseZoneData(a,b),a.fp=!0):"1"==eb(b,nd,1)&&(w.parseZoneData(a,b),a.cfp=!0,h.events.emit(h.events.eventType.bannerPrint,
a))};var od=function(){M="hidden"!=document.webkitVisibilityState;R()},Xb={bannerId:ba(h.globalParameters.attBannerId),campaignId:ba(h.globalParameters.attCampaignId),displayTime:ba(h.globalParameters.attDisplayTime),impressionId:ba(h.globalParameters.attImpressionId),remnant:ba(h.globalParameters.attRemnant),contentUrl:ba(h.globalParameters.attContentUrl),gtsTrackerUrl:ba(h.globalParameters.attTracker),close:ba(h.globalParameters.attClose)},Yb={remnant:function(a){return"1"!=a?!1:!0}};w.parseZoneData=
function(a,b,c){var c=c||{},d,g={},e={},f=c.map,c=c.tokens;for(d in Xb)g[d]=Xb[d];for(d in c)g[d]=c[d];for(d in Yb)e[d]=Yb[d];for(d in f)e[d]=f[d];for(var j in g)if(d=eb(b,g[j],1))a[j]=e[j]?e[j](d):d,w.log("parseZoneData: updated "+j+":"+a[j])};w.ready=function(){if(h.globalParameters.scriptInFrameOn){document.webkitVisibilityState&&document.addEventListener("webkitvisibilitychange",od);var a,b=h.getParam("tps","trackingPixelStyle","{}"),b=JSON.parse(b),c={width:"1px",height:"1px",position:"fixed",
top:"0px",left:"0px","z-index":"99999",display:"block",padding:"0px",margin:"0px"};for(a in b)c[a]=b[a];var d="";for(a in c)d+=a+":"+c[a]+";";a=function(a){var b='<object id="wsTrackingPixel'+a+'" height="2" width="2" classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" align="middle" style="'+d+'">\n            <param name="movie" value="http://s3.amazonaws.com/webspectator-images/ws-throttle.swf" />\n            <param name="flashVars" value="idZone='+a+'" />\n            <param name="quality" value="high" />\n            <param name="hasPriority" value="true" />\n            <param name="play" value="true" />\n            <param name="loop" value="true" />\n            <param name="wmode" value="window" />\n            <param name="scale" value="showall" />\n            <param name="menu" value="true" />\n            <param name="devicefont" value="false" />\n            <param name="salign" value="" />\n            <param name="allowScriptAccess" value="always" />\n            <\!--[if !IE]>--\>\n            <object id="wsTrackingPixel'+
a+'" data="http://s3.amazonaws.com/webspectator-images/ws-throttle.swf" style="width:  1px; height: 1px; position: fixed; top:  0px; left: 0px; z-index: 99999;" type="application/x-shockwave-flash">\n                <param name="movie" value="http://s3.amazonaws.com/webspectator-images/ws-throttle.swf" />\n                <param name="flashVars" value="idZone='+a+'" />\n                <param name="quality" value="high" />\n                <param name="hasPriority" value="true" />\n                <param name="play" value="true" />\n                <param name="wmode" value="window" />\n                <param name="loop" value="true" />\n                <param name="scale" value="showall" />\n                <param name="menu" value="true" />\n                <param name="devicefont" value="false" />\n                <param name="salign" value="" />\n                <param name="allowScriptAccess" value="always" />\n                <\!--<![endif]--\>\n                <\!--[if !IE]>--\>\n            </object>\n            <\!--<![endif]--\>\n        </object>';
if(!document.getElementById("wsTrackingPixel"+a)){var c=document.createElement("DIV");c.innerHTML=b;document.body.appendChild(c.firstChild);w.log("created flash to track zone: "+a)}};var g,b=h.zone.zones(),e;for(e in b){a((g=b[e]).id);break}var f=g,j;window.__wsZoneInView=function(a,b){w.log("[__wsZoneInView] zone:"+a+" "+("true"==b?"in":"off")+" view");if(a!=f.id)w.log("[__wsZoneInView] zoneid: "+a+" does not match with tracking zone: "+f.toString());else if(b!=j){j=b;var b="true"==b,c={timeStamp:+new Date};
M=f.currView=b;S&&S.setStatus(M?1:0);b?f.intoView(c):f.outOfView(c);R();w.log("[__wsZoneInView] zone changed to "+(b?"in":"off")+" view: "+f.toString())}}}w.log("ready tracking")};w.isFocused=function(){return M};w.isUserIdle=function(){return Ha};w.init=function(){h=m.core;$a=m.messaging;h.globalParameters.trackIdleOn&&(K=ad,K.init());var a=!h.globalParameters.scriptInFrameOn&&document.hasFocus?document.hasFocus():document.visibilityState?"hidden"!=document.visibilityState:!0;Mb&&!a?h.events.emit(h.events.eventType.blur):
h.events.emit(h.events.eventType.focus);if(Pb&&(window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver))(new (window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver)(function(){window.setTimeout(function(){R({})},500)})).observe(document,{attributes:!0,childList:!0,subtree:!0});w.log("init tracking")};w.reset=function(){Vb.reset()};Lb=h.getParam("dbh","defaultBannerHeight",155);la=h.getParam("fcs","focusOn",!0,!0);ab=h.getParam("bat","bannerAreaThreshold",
50);h.getParam("bvt","bannerVisibilityThresholdMs",500);Ga=parseInt(h.getParam("psi","pingStateIntervalMs",1E4));Kb=h.getParam("sso","sendStatusOn",!0,!0);h.getParam("tfo","trackFirstPrintOn",!1,!0);Mb=h.getParam("ifo","initFocusOn",!0,!0);Nb=h.getParam("fcv","forceCheckViewport",!1,!0);Pb=h.getParam("tdc","trackDomChanges",!1,!0);Ob=h.getParam("tze","trackZonesElement",!1,!0);cb=h.getParam("trc","trackRemnantCampaigns",!0,!0);Ia=h.getParam("uic","useIdleCookie",!0,!0);h.events.listen(h.events.eventType.zoneIn,
function(a){w.log("zone in view: "+a);pa&&a.overlay&&a.overlay.setVolatileColor("#00ff00")});h.events.listen(h.events.eventType.zoneOut,function(a){a=a.zone;w.log("zone out view: "+a.toString());h.util.raiseEvent(h.util.scriptEvents.zoneStatusChanged,{action:"inactive",zone:a})});h.events.listen(h.events.eventType.zoneInTentative,function(a){h.util.raiseEvent(h.util.scriptEvents.zoneStatusChanged,{action:"active",zone:a.zone})});h.globalParameters.scriptInFrameOn||(h.events.listen(h.events.eventType.scroll,
jd),h.events.listen("zoneSizeUpdate",hd),h.events.listen(h.events.eventType.resize,kd),h.events.listen(h.events.eventType.focus,ld),h.events.listen(h.events.eventType.blur,md),h.globalParameters.trackIdleOn&&(h.events.listen(h.events.eventType.mousemove,dd),h.events.listen(h.events.eventType.keypress,ed),h.events.listen(h.events.eventType.keydown,fd),h.events.listen(h.events.eventType.click,gd),h.events.listen(h.events.eventType.userIdle,bd),h.events.listen(h.events.eventType.userActive,cd)));var L=
h.zone.getPrototype();L.visibleThresholdHnd=null;L.currView=!1;L.enteredView=!1;L.left=-1;L.top=-1;L.width=0;L.height=0;L.visibleTime=0;L.displayTime=0;L.overlay=null;L.zoneInViewMessage=null;L.zoneTimer=null;L.campaignId=0;L.impressionId=0;L.remnant=!1;L.zoneVisibleTime=0;L.setVisibleTime=function(a){return this.visibleTime+=a};L.setZoneVisibleTime=function(a){return this.zoneVisibleTime+=a};L.intoView=h.extension.make("tracking.intoview",function(a){this.zoneTimer.start(a.timeStamp);this.enteredView=
!0;h.events.emit(h.events.eventType.zoneInTentative,{zone:this,inspection:a.inspectData})});L.outOfView=h.extension.make("tracking.outofview",function(a){var b=this.zoneTimer.stop(a.timeStamp);this.setZoneVisibleTime(b);var c=this.enteredView;this.enteredView=!1;h.events.emit(h.events.eventType.zoneOut,{zone:this,inspection:a.inspectData,inTentativeView:c,visibleTime:b,timeStamp:a.timeStamp})});h.extension.add("core.zone.init",function(){var a=this;this.visibleTime=0;this.zoneTimer=new h.util.PartialTimer;
this.viewportChanged=function(b){Ub.call(a,b)};this.log("initTracking")});h.extension.add("core.zone.start",function(){var a={};h.util.raiseEvent(h.util.scriptEvents.zoneStatusChanged,{action:"inactive",zone:this});Wb(this);var b=this.element.outerHTML,c=/data-ws-dnr=['|"]1['|"]/;this.locked=!this.fp&&b&&null!=b.match(c)?!0:!1;a.InitializeInView&&(this.log("force viewport in"),a.forceInViewport=!0);!h.globalParameters.scriptInFrameOn&&R(a);this.log("startTracking")});h.extension.add("core.zone.getdata",
function(a){a.metrics={top:this.top,left:this.left,width:this.width,height:this.height};return a});h.extension.add("core.zone.del",function(){var a=+new Date;if(this.currView){var b=this.zoneTimer.stop(a);h.events.emit(h.events.eventType.zoneOut,{zone:this,inTentativeView:this.enteredView,visibleTime:b,timeStamp:a});R()}clearInterval(this.visibleThresholdHnd);h.events.unlisten(h.events.eventType.viewportChanged,this.viewportChanged);this.overlay&&this.overlay.del();this.log("delTracking")});h.extension.add("core.zone.tostring",
function(a,b){b.currView=a.currView;b.enteredView=a.enteredView;b.left=a.left;b.top=a.top;b.width=a.width;b.height=a.height;b.visibleTime=a.visibleTime;b.zoneVisibleTime=a.zoneVisibleTime;b.displayTime=a.displayTime;b.campaignId=a.campaignId;b.impressionId=a.impressionId;b.remnant=a.remnant;b.zoneTimer=JSON.stringify(a.zoneTimer.toJSON());return b});h.extension.make("tracking.upgradeFromTentativeView",function(a){w.log("upgradeFromTentativeView: "+a);a.enteredView&&(a.enteredView=!1,h.events.emit(h.events.eventType.zoneIn,
a))});h.extension.make("tracking.inTentativeView",function(a){return a.enteredView});w.sendViewportState=R;w.sendLastViewportState=Ja;w.buildRegex=ba;w.matchRegex=eb;w.inspectElement=Tb;m.core.register("tracking",w,{});Ob&&m.core.util.executeOnPredicate(function(){var a="div."+m.core.globalParameters.zoneClassName;w.log("mutation observer on with selector: '"+a+"'");new MutationSummary({callback:function(a){var c=a[0];if(c.attributeChanged){a=c.attributeChanged;w.log("mutation: attributes changed: ");
for(var d in a)w.log("mutation: attr '"+d+"' in elements:"),a[d].forEach(function(a){w.log("data-pid: "+a.getAttribute("data-pid")+"| old value:'"+c.getOldAttribute(a,d)+"'| new value:'"+a.getAttribute(d)+"'")})}},queries:[{element:a,elementAttributes:"style"}]})},function(){return"undefined"!=typeof window.MutationSummary});var v={},e=m.core,fa,ca=m.instrumentation,r,Zb,$b,fb,ac,bc,cc,dc,Ka,ec,fc,wa=!0,gc,pd=function(a){if(!a||!(1<=a.length&&6>=a.length))return"arguments: zone ID [string]; display time secs [int=5]*; banner ID [string list]*; change mode [string=p|n|l]*; use changebanner message [int:0|1]";
var b=a[0],c=a[1]||5,d=a[2],g=a[3]||"r",f=a[5]&&("1"===a[5]?!0:!1);a[4]&&"1"===a[4]?La({a:"cb",v:"1.6",d:{z:b,b:d,u:c,c:"666",m:g,content:f?'document.write(\'<div style="width:0px;height:0px" data-iid="f84159fc75413f40" data-bid="299" data-pid="454" data-cpid="49" data-dt="20000" data-fp="1" data-bannerWidth="300" data-bannerHeight="250" ></div>\');document.write(\'<s\' + \'cript type=\\"text/javas\' + \'cript\\" >var urlPing=\\"http://services.webspectator.com/logPrint/49/299/\\" + +new Date;document.write(\\"<s\' + \'cript type=\\\\\\"text/javas\' + \'cript\\\\\\" src=\\\\\\"\\" + urlPing + \\"\\\\\\"><\\\\/s\' + \'cript>\\");<\\/s\' + \'cript><s\' + \'cript src=\\"http://bs.serving-sys.com/BurstingPipe/adServer.bs?cn=rsb&c=28&pli=5759213&PluID=0&w=300&h=250&ord=%%880518651%%&ucm=true&ifl=$$http://adserver.ig.com.br/RealMedia/ads/Creatives/OasDefault/hosting_hospedagem_300605/addineyeV2.html$$&ncu=$$http://services.webspectator.com/pc/30/299/454/e35571bc14cd6bf1?t=880518651&ckurl=http://adserver.ig.com.br/RealMedia/ads/click_lx.ads/%%PAGE%%/%%RAND%%/%%POS%%/%%CAMP%%/%%IMAGE%%/%%USER%%$$&z=99999\\"><\\/s\' + \'cript><nos\' + \'cript><a href=\\"http://services.webspectator.com/pc/30/299/454/e35571bc14cd6bf1?t=880518651&ckurl=http://adserver.ig.com.br/RealMedia/ads/click_lx.ads/%%PAGE%%/%%RAND%%/%%POS%%/%%CAMP%%/%%IMAGE%%/%%USER%%http%3A//bs.serving-sys.com/BurstingPipe/adServer.bs%3Fcn%3Dbrd%26FlightID%3D5759213%26Page%3D%26PluID%3D0%26Pos%3D7334\\" target=\\"_blank\\"><img src=\\"http://bs.serving-sys.com/BurstingPipe/adServer.bs?cn=bsr&FlightID=5759213&Page=&PluID=0&Pos=7334\\" border=0 width=300 height=250><\\/a><\\/nos\' + \'cript>\');':
null}}):(a=e.zone.getZone(b),a.changeBanner({zoneId:a.id,displayTime:1E3*c,bannerId:d,mode:g,forceEntryOptions:!0}))},qd=function(a){if(!a||1>a.length)return"arguments: zone ID [string]";e.zone.getZone(a[0]).nextBanner()},rd=function(a){if(!a||1>a.length)return"arguments: zone id [string]";var a=a[0],b=e.zone.getZone(a);if(null==b)throw"zone "+a+" not found!";b.autoUpdateOn=!b.autoUpdateOn;b.autoUpdateOn&&hc.start();a="zone "+a+" autoupdate "+(b.autoUpdateOn?"on":"off");v.log(a);return a},sd=function(a){if(!a||
1>a.length)return"arguments: zone id [string]";var a=a[0],b=e.zone.getZone(a);if(null==b)throw"zone "+a+" not found!";b.autoUpdateQueueOn=!b.autoUpdateQueueOn;a="zone "+a+" autoUpdateQueue "+(b.autoUpdateQueueOn?"on":"off");v.log(a);return a},td=function(){e.zone.eachZone(function(a){a.autoUpdateOn=!a.autoUpdateOn;return!0});v.log("toggle autoupdate in all zones");return"toggle autoupdate in all zones"},ud=function(a){if(!a||!(1<=a.length&&3>=a.length))return"arguments: zone ID [string]; display time secs [int=5]; banner ID [string list]";
var b=a[0],c=a[2],a=a[1]||5,d=e.zone.getZone(b);d.addBanner({displayTime:1E3*a,bannerId:c,zoneId:b,fetchBanner:!0});d.queue.dump();return"added banner to zone "+b+" queue"},vd=function(a){if(!a||1>a.length)return"arguments: zone ID [string];";a=a[0];e.zone.getZone(a).queue.dump();return"zone "+a+" queue dumped to log"},wd=function(a){if(!a||1>a.length)return"arguments: zone ID [string];";var a=a[0],b=e.zone.getZone(a);b.queue.clear();b.queue.dump();return"zone "+a+" queue cleared"},xd=function(a){if(!a||
1>a.length)return"arguments: zoneID; width; height";var b={};b.zone=a[0];b.width=a[1]||300;b.height=a[2]||250;a=new ic.overlayBanner(b,0);e.zone.createZone(a.zone,a.contentDiv,{InitializeInView:!1});b=e.zone.getZone(a.zone);b.nextBanner();b.isOverlay=a};e.events.listen(e.events.eventType.instrumentationLoaded,function(){ca&&(ca.addOper("zone - change banner",pd),ca.addOper("zone - next banner",qd),ca.addOper("zone - toggle autoUpdate",rd),ca.addOper("zone - toggle autoUpdateQueue",sd),ca.addOper("zones - toggle autoupdate",
td),ca.addOper("zone - add banner",ud),ca.addOper("zone - dump queue",vd),ca.addOper("zone - clear queue",wd),ca.addOper("zones - add slider",xd))});var T=document.createElement("img"),jc=10,yd=(new Date).getTime();T.setAttribute("height","1px");T.setAttribute("width","1px");T.src="//images.webspectator.com/px.png?time="+yd;T.alt="";T.style.position="absolute";T.style.top="0px";T.style.left="0px";document.body.appendChild(T);-1==navigator.appName.indexOf("Microsoft Internet Explorer")&&navigator.appName.indexOf("Chrome");
jc=1E3;setTimeout(function(){-1!=navigator.appName.indexOf("Microsoft Internet Explorer")?(T.onabort=function(){wa=!1},T.onerror=function(){wa=!1}):-1==navigator.appName.indexOf("Opera")&&"undefined"!=typeof T.naturalWidth&&0==T.naturalWidth&&(wa=!1);T.complete||(wa=!1)},jc);var kc=function(a,b){b.fetchingBanner=!0;b.requestBeginTs=+new Date;var c=b.requestEndTs=0;(function g(e){c++;b.retriesHnd=setTimeout(function(){var e;fa.sendChangeBannerRequest({websiteId:b.websiteId||null,pid:a.id,state:b.index+
","+c,script:"undefined"!=typeof b.script?b.script:gc,bannerId:b.bannerId,cpid:b.campaignId&&0!=b.campaignId?b.campaignId:null});c<fb?(e=a.queue.get(b.index),e.fetchingBanner?(v.log("cbreq - send requesting (retry:"+c+")"),g(ac)):v.log("cbreq - stop retries for entry: "+e.toString())):v.log("cbreq - reached max retries: "+fb)},e)})(0)},xa=new function(){var a=[];this.register=function(b,c){a[a.length]={cb:b,scope:c};return this};this.reset=function(){a=[]};this.signal=function(){for(var b=a.length;b--;)"function"==
typeof a[b].cb&&a[b].cb.apply(a[b].scope||null,Array.prototype.slice.call(arguments))}},lc,zd=/"/g,Ad=/\n|\r/g,Bd=/<script/gi,Cd=/<\/script/gi;lc=function(a){var b=document.createElement("script"),c="ws_cb_"+a.zone+"_"+ +new Date,d=a.contentUrl+(-1!=a.contentUrl.indexOf("?")?"&":"?")+"callback="+c;v.log("fetching banner data with src: '"+d+"'");b.setAttribute("src",d);document.body.appendChild(b);window[c]=function(d){a.content=a.content.replace('data-tracker=""','data-tracker="'+d.impressionUrl+
'"');d.flash&&(a.content+=d.flash);d=d.banner.replace(zd,'\\"').replace(Ad,"").replace(Bd,'<scr" + "ipt').replace(Cd,'</scr" + "ipt').replace("<\!--// <![CDATA[","").replace("// ]]\> --\>","");a.content+='document.write("'+d+'")';a.ignoreContentUrl=!0;La({a:"cbresp",d:a},!0);document.body.removeChild(b);delete window[c]}};var La=function(a,b){v.log("changeBanner with message: "+JSON.stringify(a));var c,d,g,f,p,j,k=a.d;if(b)if(d={created:+new Date},d.zoneId=k.zone,c=e.zone.getZone(d.zoneId))if(j=e.util.trim(k.content||
""),!j&&c.isOverlay)2>c.isOverlay.retries&&(c.isOverlay.retries++,Ka?c.isOverlay.close():c.nextBanner());else{r.parseZoneData(d,j);null!=j.match(/data-ws-dnr=['|"]1['|"]/)&&(this.locked=!0);g=j.match(/data-type=['|"]([a-zA-Z]*)['|"]/);if(null!=g&&(d.bannerType=g[1],!wa&&("image"==g[1]||"flash"==g[1]&&!swfobject.hasFlashPlayerVersion("8"))))delete d.bannerId,delete d.campaignId;d.entryId=k.state.split(",")[0];d.html=j;d.close?!Ka&&c.isOverlay?c.isOverlay.close():(v.log("hide banner content in zone: "+
c.id),0<c.element.childNodes.length&&(c.element.childNodes[parseInt(c.queue.getPrevious().node,10)].style.display="none",c.wsOwner=!1,r&&r.sendViewportState())):(j&&c.isOverlay&&(c.isOverlay.retries=0),!k.ignoreContentUrl&&d.contentUrl?(k.contentUrl=d.contentUrl,lc(k)):c.bannerFetched(d))}else v.log("zone not found in change banner: "+d.zoneId);else{d=k.z;g=k.b;f=k.c;p=k.i;j=k.content;var n=k.u;if(c=e.zone.getZone(d)){if(!j&&(dc&&(gb.setGtsTracker(c,c.queue.getCurrent()),gb.setGtsTrackerInternal(c,
c.queue.getCurrent())),c.isOverlay)){2>c.isOverlay.retries&&(c.isOverlay.retries++,Ka?c.isOverlay.close():c.nextBanner());return}!c.currView&&!c.isOverlay?v.log("change banner in off view zone not allowed: "+d):(j&&(c.isOverlay&&(c.isOverlay.retries=0),j=j.replace("[WS-SESSIONID]",e.globalParameters.sessionId),"undefined"==typeof p&&(p=r.matchRegex(j,r.buildRegex("data-iid"),1))),-1<ec.indexOf(c.id)?(e.zone.deleteZone(c.id),r&&r.sendViewportState()):c.changeBanner({displayTime:1E3*n,bannerId:g,campaignId:f,
impressionId:p,html:j,data:k,mode:k.m}))}else v.log("zone not found in change banner: "+d)}},hb=[],mc=function(a){switch(a.a){case "cb":La(a);break;case "cbresp":La(a,!0);break;default:v.log("!!unknown action in message: "+JSON.stringify(a))}};e.events.listen(e.events.eventType.userActive,function(){var a=hb.slice(0),b;hb=[];for(var c=0,d=a.length;c<d;c++)b=a[c],v.log("processing message from queue: "+JSON.stringify(b)),mc(b);v.log("flushed "+d+" messages from queue")});var hc=new function(a){var b,
c=function(b){a.log("bannersUpdateManager: "+b)};this.run=function(a){var b;b=+new Date;if((a.autoUpdateOn||a.autoUpdateQueueOn&&!a.queue.isQueueEmpty()||0<a.updateCount)&&!a.throttlingBannerUpdate&&a.currView&&!a.processingBanner&&!a.isFetchingCurrentBanner())b=a.calculateVisibleTime(b),b>=a.displayTime&&(c("next banner for zone: "+a+" | curr display time: "+b),a.nextBanner())};this.start=function(){!b&&(b=!0)&&xa.register(this.run)};var d=function(a,b){a[b]=!0;c("set "+b+" in zone: "+a.id)};this.init=
function(){var a,b;b=e.getParam("luz","listAutoUpdateZones","");if(""!=(b=e.util.trim(b)))if("*"==b)e.zone.eachZone(function(a){d(a,"autoUpdateOn")});else{b=b.split(",");for(var c=0,j=b.length;c<j;c++)(a=e.zone.getZone(b[c]))&&d(a,"autoUpdateOn")}b=e.getParam("lqz","listAutoUpdateQueueZones","");if(""!=(b=e.util.trim(b)))if("*"==b)e.zone.eachZone(function(a){d(a,"autoUpdateQueueOn")});else{b=b.split(",");c=0;for(j=b.length;c<j;c++)(a=e.zone.getZone(b[c]))&&d(a,"autoUpdateQueueOn")}e.getParam("tbu",
"trackBannersUpdateOn",!1,!0)&&this.start()}}(v),gb=new function(a){var b,c=function(a,b){var c;!b.gtsTrackerSent&&b.gtsTrackerUrl&&(b.gtsTrackerUrl=b.gtsTrackerUrl.replace("[RANDOM]",Math.floor(99999999*Math.random())+999),c="gtstracker-"+a.id+"-"+b.bannerId+"-"+(b.entryId||0),g(c,b.gtsTrackerUrl),b.gtsTrackerSent=!0)},d=function(a,c){if(b&&!c.gtsTrackerInternalSent){var d,k;"["==b[0]?k=JSON.parse(b):(k=[])&&k.push(b);for(var f=0,h=k.length;f<h;f++)d="gtstrackeri-"+a.id+"-"+c.bannerId+"-"+c.entryId,
g(d,e.util.trim(k[f]));c.gtsTrackerInternalSent=!0}},g=function(b,c){a.log("gtsUrlTrackerHelper: "+("### add GTS tracker with class: "+b+" to DOM with url: "+c));var d=document.createElement("IMG");d.setAttribute("class",b);d.setAttribute("style","width:0;height:0;display:none;");d.setAttribute("src",c);document.body.appendChild(d)};this.setGtsTracker=c;this.setGtsTrackerInternal=d;this.init=function(){var a=e.getParam("gto","gtsTrackerOn",!1,!0),g=e.getParam("gti","gtsTrackerInternalOn",!1,!0);b=
e.getParam("lgt","listGtsTrackerUrls","");((b=e.util.trim(b))||a)&&e.events.listen("bannerGts",function(b,e){a&&c(b,e);g&&d(b,e)})}}(v),Dd=new function(a){var b={},c,d=function(b){a.log("updateOnGtsHelper: "+b)},g=function(a){var c;if(c=b[a.id])h(a,c),d("triggered update banner in zone: "+a.id+" with delay: "+c),delete b[a.id]},f=function(){var a,c;for(id in b)a=b[id],c=e.zone.getZone(id),c.currView&&(h(e.zone.getZone(id),a),d("triggered update banner in zone: "+id+" with delay: "+a),delete b[id])},
h=function(a,b){setTimeout(function(){a.nextBanner()},b)};this.init=function(){var a,k=e.getParam("lug","listUpdateOnGtsZones",""),k=e.util.trim(k);if(""!=k){var n=[];if(0==k.indexOf("["))n=JSON.parse(k);else if(0==k.indexOf("{"))n=[JSON.parse(k)];else if("*"==k)e.zone.eachZone(function(b){!b.fp&&(!b.cfp&&!b.isOverlay&&!b.sideBanner)&&n.push({z:b,d:a})});else{var aa=k.split(",");if(1==aa.length&&""==e.util.trim(aa[0]))return;for(var n=[],k=0,N=aa.length;k<N;k++)n.push({z:aa[k],d:a})}k=n.length;a=
e.getParam("ugs","updateGTSMs",2E4);for(c=e.getParam("ugv","updateGTSOnView",!0,!0);k--;){if("object"!=typeof(N=n[k].z))N=e.zone.getZone(N);N&&(aa=n[k].d||a,d("update banner in zone: "+N.id+" with delay: "+aa),!c||N.currView&&r.isFocused()&&!r.isUserIdle()?h(N,aa):b[N.id]=aa)}e.events.listen(e.events.eventType.bannerInTentative,g);e.events.listen(e.events.eventType.focus,f);e.events.listen(e.events.eventType.userActive,f)}}}(v),Ed=new function(a){var b={},c,d,g,f=function(b){a.log("gtsTrackerHelper: "+
b)},h=function(a){var g=+new Date;if(a.trackGtsEnabled&&a.currView){var n=b[a.id]||0,g=a.calculateVisibleTime(g),h=parseInt(g/c);h>n?(b[a.id]=h,f("gts #"+h+" in zone: "+a),d&&(n={bannerId:a.bannerId,zoneId:a.id,campaignId:a.campaignId,action:"gts"},fa&&fa.sendGtsNotification(n)),e.events.emit(e.events.eventType.bannerGts,a,a.queue.getCurrent())):h<n&&(f("reset gts with visible time "+g),b[a.id]=0)}};this.init=function(){g=e.getParam("lgz","listGtsZones","");if(""!=(g=e.util.trim(g))){c=e.getParam("gts",
"gtsDurationMs",2E4);d=e.getParam("gno","gtsNotificationOn",!1,!0);e.getParam("sgo","sendStatusOnGtsOn",!0,!0);var a=[];"*"==g?e.zone.eachZone(function(b){a.push(b)}):a=g.split(",");for(var b=a.length,f;b--;)f=a[b],"string"==typeof f&&(f=e.zone.getZone(f)),f&&(f.trackGtsEnabled=!0);xa.register(h)}}}(v),Fd=new function(a){var b={},c={},d,g,f=function(b){a.log("gtsReportHelper: "+b)},h=function(a){if(a.reportGtsEnabled&&a.currView){var e=+new Date,h=b[a.id]||0,p=a.calculateZoneVisibleTime(e);parseInt(p/
d)>h++&&(b[a.id]=h,f("report gts #"+h+" in zone: "+a),j("gtsr",a));g&&(h=c[a.id]||0,e=parseInt(a.calculatePartialZoneVisibleTime(e)/d),e>h?(c[a.id]=e,f("report contiguous gts #"+e+" in zone: "+a),j("gtscr",a)):e<h&&(c[a.id]=0))}},j=function(a,b){var c={bannerId:b.bannerId,zoneId:b.id,campaignId:b.campaignId,action:a};fa&&fa.sendGtsNotification(c)};this.init=function(){var a=e.getParam("lrg","listReportGtsZones","");if(""!=(a=e.util.trim(a))){d=e.getParam("rgd","reportGtsDurationMs",2E4);g=e.getParam("rcg",
"reportContinuousGtsOn",!1,!0);var b=[];"*"==a?e.zone.eachZone(function(a){b.push(a)}):b=a.split(",");for(var c=0,j=b.length;c<j;c++)if(a="string"==typeof b[c]?e.zone.getZone(e.util.trim(b[c])):b[c])a.reportGtsEnabled=!0,f("reporting gts on zone: "+a.id);xa.register(h)}}}(v),Gd=new function(a){var b,c,d,g={},f={},h,j=function(b){a.log("impressionsLogger: "+b)},k=function(a,b){var c={action:b,zoneId:a.id,bannerId:a.bannerId,campaignId:a.campaignId};h&&h.sendGtsNotification(c)},n=function(a){j("banner in tentative view in zone: "+
a);var c,d=a.id,e;if((c=f[d])&&c.impressionId==a.impressionId)e=+new Date,g[d]={hnd:setTimeout(function(){j("iab 1st print for zone: "+a+" at: "+ +new Date);k(a,"iabp");delete g[d]},b),targetTime:e+b,createTime:e},j("iab print for 1st print zone: "+a+" with saved zone data: "+JSON.stringify(c)),delete f[a.id]},aa=function(a,b){j("banner out: "+a+"\nwith options: "+JSON.stringify(b));var c=g[a.id];if(c){var d=a.id;clearTimeout(c.hnd);j("cleared timer for zone: "+d+" with data: "+JSON.stringify(c));
delete g[d]}},m=function(a,c){j("banner print: "+a+"\nwith options: "+JSON.stringify(c));if(a.currView){var d=a.id,e=+new Date,f=b-(e-c.timeStamp),h=e+f;g[d]={hnd:setTimeout(function(){j("iab print for zone: "+a+" at: "+ +new Date);k(a,"iabp");delete g[d]},f),targetTime:h,createTime:e};j("updated timers: "+JSON.stringify(g))}else j("zone off view")};this.init=function(){if(e.getParam("lpo","logPrintsOn",!1,!0)){d=e.getParam("l2p","log2ndPrints",!1,!0);c=e.getParam("lph","logPrintsHiddenZones",!0,
!0);b=e.getParam("lpd","logPrintsDuration",1E3);h=fa;var a,g=e.zone.zones(),l;for(l in g)a=g[l],j("print for zone: "+a),k(a,"tp"),a.currView?(j("iab print for zone: "+a+" at: "+ +new Date),k(a,"iabp")):c&&(f[a.id]={snapshot:a.toString(),impressionId:a.impressionId});d&&(e.events.listen(e.events.eventType.bannerPrint,m),e.events.listen(e.events.eventType.bannerOut,aa));c&&e.events.listen(e.events.eventType.bannerInTentative,n)}}}(v),ic=new function(){var a,b=!!e.util.cookies.readCookie("ws-obp"),c;
this.overlayBanner=function(a,c){this.zone=a.zone;this.width=a.width;this.height=a.height;this.replacer=a.replacer&&JSON.parse(a.replacer);this.posX=a.posX||{pos:"right",dist:0};this.posY=a.posY||{pos:"bottom",dist:0};this.timeout=a.timeout||0;this.alwaysInside="undefined"!=typeof a.alwaysInside?a.alwaysInside:!0;this.contentDiv=this.closeDiv="";this.shadowDiv=a.overlayPage||!1;this.displayTimeout=0;this.animeInterval=null;this.animation=a.animation||"vertical";this.animeIter=a.animeIter||100;this.animeDur=
a.animeDur||2;this.iterations=0;this.zIndex=a.zIndex||2147483646;this.border="undefined"!=typeof a.border?a.border:!0;this.started=!1;this.animString=a.animString;this.transEvent=a.transEvent;this.reOpen=a.reOpen||"true";this.retries=0;this.isVisible=!1;this.repDist=a.repDist;var f=!1;this.updateClose=function(){this.closeDiv.style.left=parseInt(this.contentDiv.style.width.substr(0,this.contentDiv.style.width.length-2))-10+"px"};this.updateLeft=function(){this.decorator.style.left=this.posX.dist-
e.util.viewport.scrollLeft()+"px"};this.updateSize=function(){for(var a=e.zone.getZone(this.replacer).element,b=a.offsetLeft;a.offsetParent;)a=a.offsetParent,b+=a.offsetLeft;this.posX.dist=b;this.decorator.style.left=this.posX.dist-e.util.viewport.scrollLeft()+"px"};this.setCss=function(){this.contentDiv.style.width=this.width+"px";this.contentDiv.style.height=this.height+"px";var a=this.decorator;a.style.display="none";a.style.zIndex=this.zIndex;if("center"!=this.posX.pos)if(c){var d=this.posX.dist+
(e.util.viewport.width()-c.substring(0,c.length-2));a.style[this.posX.pos]=0<d?d/2+"px":d+"px"}else a.style[this.posX.pos]=this.posX.dist+"px";else a.style.setProperty?(a.style.setProperty("margin","0 auto","important"),a.style.setProperty("left","0px","important"),a.style.setProperty("right","0px","important")):(a.style.setAttribute("margin","0 auto","important"),a.style.setAttribute("left","0px","important"),a.style.setAttribute("right","0px","important"));a.style[this.posY.pos]=this.posY.dist+
"px";a.style.position=this.alwaysInside?"fixed":"absolute";this.border?(this.decorator.style.width=this.width+20+"px",this.decorator.style.height=this.height+30+"px",this.decorator.style.backgroundColor="#f2f2f2",this.decorator.style.border="1px solid #cccccc",this.decorator.style.borderRadius="bottom"==this.posY.pos?"5px 5px 0px 0px":"0px 0px 5px 5px",this.contentDiv.style.margin="0px auto",this.contentDiv.style.bottom="2px"):(this.decorator.style.width=this.width+"px",this.decorator.style.height=
this.height+"px",this.contentDiv.style.position="absolute",this.contentDiv.style.top="0px");this.animString&&"vertical"==this.animation&&(this.decorator.style[this.animString]=this.posY.pos+" "+this.animeDur+"s",b[this.zone]||(this.decorator.style[this.posY.pos]=-1*this.height+"px",e.util.DOM.getElementCss(this.decorator)[this.posY.pos],this.decorator.style[this.posY.pos]=this.posY.dist+"px"));this.minimize()};this.animate=function(a){var b=this.decorator;if("grow"==this.animation)this.contentDiv.style.width=
this.iterations/this.animeIter*this.width+"px",this.contentDiv.style.height=this.iterations/this.animeIter*this.height+"px",this.updateClose(),this.iterations++>=this.animeIter&&(clearInterval(this.animeInterval),r&&r.sendViewportState());else if("vertical"==this.animation&&!this.animString)if(f)if(a){var d=parseInt(b.style[this.posY.pos].substr(0,b.style[this.posY.pos].length-2))+10;b.style[this.posY.pos]=d+"px";d>=this.posY.dist&&(f=!f,clearInterval(this.animeInterval),r&&r.sendViewportState())}else d=
parseInt(b.style[this.posY.pos].substr(0,b.style[this.posY.pos].length-2))-10,b.style[this.posY.pos]=d+"px",d<=-1*this.height-10&&(f=!f,clearInterval(this.animeInterval),r&&r.sendViewportState());else{f=!f;var h=this;this.animeInterval=setInterval(function(){h.animate(a)},1E3*(this.animeDur/this.animeIter))}else"horizontal"==this.animation&&(this.animString?(b.style[this.animString]=this.posX.pos+" "+this.animeDur+"s",b.style[this.posX.pos]=-1*this.width+"px",e.util.DOM.getElementCss(b)[this.posX.pos],
b.style[this.posX.pos]=this.posX.dist+"px"):f?(d=parseInt(b.style[this.posX.pos].substr(0,b.style[this.posX.pos].length-2))+10,b.style[this.posX.pos]=d+"px",d>=this.posX.dist+(e.util.viewport.width()-c.substring(0,c.length-2))/2&&(clearInterval(this.animeInterval),r&&r.sendViewportState())):(f=!f,b.style[this.posX.pos]=-1*this.width+"px",h=this,this.animeInterval=setInterval(function(){h.animate()},1E3*(this.animeDur/this.animeIter))))};this.forceTop=function(a){var b=document.getElementsByTagName("*"),
c;for(c in b){var d=b[c],g=e.util.DOM.getElementCss(d);g&&2147483646==g.zIndex&&(d.style.zIndex="2147483645!important")}a.style.zIndex="2147483646!important"};this.show=function(){this.decorator.style.display="block";var a=this;this.toggled&&(this.border&&this.maximize(),r&&r.sendViewportState());this.timeout&&(this.displayTimeout=setTimeout(function(){a.close()},1E3*this.timeout))};this.close=function(){var a=this.decorator;a.style.display="none";if("true"==this.reOpen){this.contentDiv.style.display=
"none";var b=this;window.setTimeout(function(){b.replacer?(b.started=!1,b.checkView()):e.zone.getZone(b.zone).nextBanner()},2E4)}else this.replacer?this.started=!1:(this.displayTimeout&&clearTimeout(this.displayTimeout),a.parentNode.removeChild(a),this.shadowDiv&&this.shadowDiv.parentNode.removeChild(this.shadowDiv),e.zone.deleteZone(this.zone));r&&r.sendViewportState();this.isVisible=!1};this.shadowOverlay=function(){if(this.shadowDiv){this.shadowDiv=document.createElement("DIV");this.contentDiv.style.zIndex=
this.zIndex-1;this.shadowDiv.style.background="#000000";this.shadowDiv.style.opacity="0.6";this.shadowDiv.style.position="absolute";this.shadowDiv.style.top=0;this.shadowDiv.style.bottom=0;this.shadowDiv.style.left=0;this.shadowDiv.style.right=0;this.shadowDiv.setAttribute("id","shadow");document.body.appendChild(this.shadowDiv);var a=this;e.util.bind(this.shadowDiv,"click",function(){a.shadowDiv.parentNode.removeChild(a.shadowDiv);a.shadowDiv=null})}};this.createHeader=function(){if(this.border){var a=
this,c=document.createElement("DIV");c.style.width=this.width+"px";c.style.margin="0px auto";c.style.height="20px";c.style.position="relative";var d=document.createElement("IMG");d.src="http://images.webspectator.com/logo.png";d.style.width="16px";d.style.paddingTop="2px";d.style.display="inline";c.appendChild(d);d=document.createElement("IMG");d.src="bottom"==this.posY.pos?"http://images.webspectator.com/btn_fechar.png":"http://images.webspectator.com/btn_expandir.png";d.style.paddingTop="6px";d.style.paddingLeft=
"2px";d.style.right="0px";d.style.width="9px";d.style.position="absolute";d.style.cursor="pointer";this.toggled=!b;e.util.bind(d,"click",function(){a.toggle()});c.appendChild(d);this.animString&&(this.decorator.style[this.animString]="bottom "+this.animDur+"s");e.util.bind(this.decorator,this.transEvent,function(){r&&r.sendViewportState()});this.toggleImg=d;return c}this.closeDiv=document.createElement("DIV");this.closeDiv.style.zIndex=this.zIndex+1;this.closeDiv.style.position="relative";this.closeDiv.innerHTML=
"<img style='width=100%; align:right;' src = 'http://images.webspectator.com/close.png'></img>";this.updateClose();a=this;e.util.bind(this.closeDiv,"click",function(){a.close()});return this.closeDiv};this.maximize=function(){this.toggleImg.src="bottom"==this.posY.pos?"http://images.webspectator.com/btn_fechar.png":"http://images.webspectator.com/btn_expandir.png";e.util.DOM.getElementCss(this.decorator)[this.posY.pos];this.contentDiv.style.display="block";this.animString?this.decorator.style[this.posY.pos]=
this.posY.dist+"px":this.animate(!0)};this.minimize=function(){this.toggleImg.src="bottom"==this.posY.pos?"http://images.webspectator.com/btn_expandir.png":"http://images.webspectator.com/btn_fechar.png";this.decorator.style.top="";this.contentDiv.style.display="none";this.animString?this.decorator.style[this.posY.pos]=-1*this.decorator.style.height.substring(0,this.decorator.style.height.length-2)+20+"px":this.animate(!1)};this.toggle=function(){(this.toggled=!this.toggled)?(e.util.cookies.eraseCookie("ws-obp"),
this.maximize()):(e.util.cookies.createCookie("ws-obp",1,5/1440),this.minimize());r&&r.sendViewportState()};this.checkView=function(){var a=!1;for(z in this.replacer){var b=e.zone.getZone(this.replacer[z]);if(b&&(this.repDist?(a="top"==this.posY.pos?this.posY.dist+e.util.viewport.scrollTop():e.util.viewport.height()-this.posY.dist-this.height+e.util.viewport.scrollTop(),a=a<b.top+b.height+this.repDist&&a>b.top-this.repDist-this.height&&b.currView):a=b.currView,a))break}a&&r&&r.isFocused()?(this.decorator.style.display=
"none",this.toggled&&this.minimize(),r&&r.sendViewportState(),this.isVisible=!1):!a&&(!this.isVisible&&r&&r.isFocused())&&(this.started?(this.show(),this.isVisible=!0):(b=e.zone.getZone(this.zone),2>b.isOverlay.retries&&(b.isOverlay.retries++,b.nextBanner(),this.started=!0)))};this.contentDiv=document.createElement("DIV");this.decorator=document.createElement("DIV");this.contentDiv.setAttribute("data-pid",this.zone);var h=this.createHeader();this.setCss();this.shadowOverlay();"bottom"==this.posY.pos?
(this.decorator.appendChild(h),this.decorator.appendChild(this.contentDiv)):(this.decorator.appendChild(this.contentDiv),this.decorator.appendChild(h),h.style.bottom="0px",this.contentDiv.style.marginTop="10px",h.style.position="absolute",h.style.left="10px");this.contentDiv.style.display="none";document.body.appendChild(this.decorator);this.repositionDiv=function(){var a=this.posX.dist+(e.util.viewport.width()-c.substring(0,c.length-2));this.decorator.style[this.posX.pos]=0<a?a/2+"px":a+"px"};if(c){var j=
this;e.util.bind(window,"resize",function(){j.repositionDiv()})}this.replacer&&(j=this,this.repDist&&(e.events.listen(e.events.eventType.scroll,j.checkView,j),e.events.listen(e.events.eventType.resize,j.checkView,j)),e.events.listen(e.events.eventType.bannerInTentative,j.checkView,j),e.events.listen(e.events.eventType.bannerOut,j.checkView,j),e.events.listen(e.events.eventType.focus,j.checkView,j))};this.init=function(){c=JSON.parse(e.getParam("obc","overlaybannercontainer","{}"));c.type||(c=0);"id"==
c.type&&(c=e.util.DOM.getElementCss(document.getElementById(c.value)).width);"class"==c.type&&(c=e.util.DOM.getElementCss(document.getElementsByClassName(c.value)[0]).width);var b=!1,g="transition",f="transitionend",h=["webkit","Moz","O","MS","Khtml"],j="";"undefined"!=typeof document.body.style.transition&&(b=!0);if(!1===b)for(j=0;j<h.length;j++)if(void 0!==document.body.style[h[j]+"Transition"]){j=h[j];g=j+"Transition";f=g+"End";b=!0;break}a=JSON.parse(e.getParam("obp","overlayBannerParameters",
"[]"),c);for(j=a.length;j--;){var k=a[j],h=!0;if(k.dep){var h=!1,n=k.dep.split(","),m=e.zone.zones(),l;for(l in m)if(h=-1<n.indexOf(m[l].id))break}if(k.ndep&&h){var n=k.ndep.split(","),q;for(q in n)if(e.zone.getZone(n[q])){h=!1;break}}h&&(b&&(k.animString=g,k.transEvent=f),h=new this.overlayBanner(k,c),n=e.zone.createZone(h.zone,h.contentDiv,{InitializeInView:!1}),n.isOverlay=h,k.replacer?n.isOverlay.checkView():function(a){window.setTimeout(function(){a.nextBanner()},k.delay||0)}(n))}v.log("init overlay")}}(v),
Hd=new function(){var a,b,c,d;this.sideBanner=function(g){this.id=g.id;this.side=g.side||"right";this.width=g.width||160;this.height=g.height||600;this.ratio=g.visib||0.5;this.currPos=0;this.dep=g.dep;this.ndep=g.ndep;this.offset=g.offset||0;this.maxScroll=g.maxScroll;this.fixDist=g.fixDist||0;this.top;this.element;this.findPosition=function(){for(var b=a.offsetLeft,c=a;c.offsetParent&&"BODY"!=c.offsetParent.nodeName.toUpperCase();)c=c.offsetParent,b+=c.offsetLeft;return"left"==this.side?b-this.width-
10+this.offset:b+10+e.util.DOM.getElementWidth(a)+this.offset};this.checkPosition=function(){this.maxScroll&&this.maxScroll<e.util.viewport.scrollTop()?3!=this.currPos&&(this.currPos=3,this.element.style.position="absolute",this.element.style.top=this.maxScroll+"px"):e.util.viewport.scrollTop()+this.fixDist<this.top&&1!=this.currPos?(this.element.style.position="absolute",this.element.style.top=this.top+"px",this.currPos=1):e.util.viewport.scrollTop()+this.fixDist>=this.top&&2!=this.currPos&&(this.element.style.position=
"fixed",this.element.style.top=this.fixDist+"px",this.currPos=2)};this.showAdZone=function(){if(this.element)this.element.style.display="block";else{this.element=document.createElement("DIV");document.body.appendChild(this.element);this.element.style.width=this.width+"px";this.element.style.height=this.height+"px";"left"==this.side?(this.top=b,b+=this.height+5):(this.top=c,c+=this.height+5);if("absolute"==d)this.element.style.position="absolute",this.element.style.top=this.top+"px";else{var a=this;
window.attachEvent?window.attachEvent("onscroll",function(){a.checkPosition()}):window.addEventListener("scroll",function(){a.checkPosition()});this.checkPosition()}var g=e.zone.createZone(this.id,this.element,{InitializeInView:!0});g.sideBanner=!0;g.nextBanner()}r&&r.sendViewportState()};this.hideAdZone=function(){this.element&&(this.element.style.display="none",r&&r.sendViewportState())};this.reposition=function(){var a=this.findPosition();this.element.style.left=a+"px"};this.fits=function(){return this.findPosition()>
-1*this.width*(1-this.ratio)&&this.findPosition()<e.util.viewport.width()-this.width*this.ratio};this.onResize=function(){this.fits()?(this.showAdZone(),this.reposition()):this.hideAdZone()};g=!0;if(this.dep){var g=!1,f=this.dep.split(","),h=e.zone.zones(),j;for(j in h)if(g=-1<f.indexOf(h[j].id))break}if(this.ndep&&g){j=this.ndep.split(",");for(var k in j)if(e.zone.getZone(j[k])){g=!1;break}}g&&(this.onResize(),e.events.listen(e.events.eventType.resize,this.onResize,this))};this.init=function(){var g=
JSON.parse(e.getParam("sbp","sideBannerParameters","{}"));if(g.dockId)if(a=document.getElementById(g.dockId),b=c=g.top||0,d=g.sticky||"dynamic",a)for(var f=0;f<g.zones.length;f++)new this.sideBanner(g.zones[f]);else v.log("sidebanner dock element not found")}}(v),Id=new function(){var a,b;this.stickyBanner=function(c){var d=e.zone.getZone(c);if(d){var g=d.top,f=d.left,h=d.element.style.position,j=""==d.element.style.left?0:parseInt(d.element.style.left.substring(0,d.element.style.left.length-2)),
k=d.element.style.top,n=d.element.parentNode,m=!1,l=document.createElement("IMG"),q=!1,c=function(){var c=e.util.viewport.scrollTop(),n=e.util.DOM.documentHeight();!q&&(m&&c+a<=g)&&(d.element.style.position=h,d.element.style.left=j,d.element.style.top=k,m=!1,l.style.display="none");!q&&m&&n-c-a-d.height<b?(d.element.style.position="fixed",d.element.style.top="",d.element.style.bottom=b+"px",m=!1):!q&&(!m&&c+a>g&&n-c-a-d.height>=b)&&(d.element.style.position="fixed",d.element.style.bottom="",d.element.style.left=
f+"px",d.element.style.top=a+"px",m=!0,l.style.display="block")};l.src="http://images.webspectator.com/close.png";l.setAttribute("class","wsOverlay");l.style.zIndex=2147483647;l.onclick=function(){d.element.style.position=h;d.element.style.left=j;d.element.style.top=k;m=!1;l.style.display="none";q=!0};l.style.top="0px";l.style.right="-10px";l.style.position="absolute";l.style.display=m?"block":"none";d.element.appendChild(l);window.attachEvent?window.attachEvent("onscroll",c):window.addEventListener("scroll",
c);e.events.listen(e.events.eventType.resize,function(){var a=n.offsetLeft+j,b=e.util.DOM.getElementCss(n);if(b.position&&"fixed"==b.position)a+=scrollLeft;else for(b=n;"HTML"!=b.nodeName&&b.offsetParent;){var b=b.offsetParent,c=e.util.DOM.getElementCss(b);if(c.position&&"fixed"==c.position){a+=scrollLeft+b.offsetLeft;break}a+=b.offsetLeft}f=a;m&&(d.element.style.left=f+"px")})}};this.init=function(){var c=JSON.parse(e.getParam("lsz","listStickyZones","{}"));a=c.top||0;b=c.bot||0;if(c.zones)for(var d=
0;d<c.zones.length;d++)new this.stickyBanner(c.zones[d])}}(v);v.init=function(){fa=m.messaging;r=m.tracking;v.log("init display")};v.reset=function(){xa.reset()};v.ready=function(){e.globalParameters.scriptInFrameOn||(ic.init(),Hd.init(),Id.init());Ed.init();Dd.init();gb.init();hc.init();Gd.init();Fd.init();v.log("ready display")};$b=e.getParam("bdt","bannerDisplayTime",2E4);Zb=e.getParam("tlo","timerLoopEventOn",!0,!0);ac=e.getParam("rbd","requestBannerRetryDelayMs",2E3);e.getParam("sbv","sendBitInViewOn",
!1,!0);fb=e.getParam("rbr","requestBannerMaxRetries",1);gc=e.getParam("rsm","cbReqScriptMode",1);bc=e.getParam("ubv","updateBannerOnView",!0,!0);cc=e.getParam("uve","updateBannerOnViewExceptions","").split(",");dc=e.getParam("tsg","gtsTrackerServerOn",!1,!0);ec=e.getParam("orz","oneRotationZones","").split(",");Ka=e.getParam("coe","closeOnEmpty",!0,!0);fc=e.getParam("rar","removeAfterRotation",!1,!0);e.events.listen(e.events.eventType.bannerIn,function(a){v.log("banner in view: "+a.bannerId+" in zone: "+
a)});e.events.listen(e.events.eventType.bannerInTentative,function(a){v.log("banner in tentative view: "+a.bannerId+" in zone: "+a);if(a.updateOnView){var b=a.updateOnView.entry,c=a.updateOnView.cb;a.updateOnView=null;a.updateBanner(b,c)}else a.bitPayload&&(fa&&fa.sendImpressionNotification(a.bitPayload),a.bitPayload=null)});e.events.listen(e.events.eventType.bannerOut,function(a){v.log("banner out view: "+a.bannerId+" in zone: "+a)});e.events.listen(e.events.eventType.bannerPrint,function(a){v.log("onBannerPrint\n"+
a);r&&r.sendViewportState();a.fp&&(a.fp=!1);e&&e.util.raiseEvent(e.util.scriptEvents.zoneStatusChanged,{action:"bannerChanged",zone:a})});e.events.listen(e.events.eventType.messageReceived,function(a){e.globalParameters.trackIdleOn&&r&&r.isUserIdle()?(hb.push(a),v.log("user idle: message enqueued")):mc(a)});e.events.listen(e.events.eventType.bannerResize,function(a){var b=e.zone.getZone(a.pid);b.width=a.banner.width;b.height=a.banner.height;document.getElementById(a.id).style.width=a.zone.width+"px";
document.getElementById(a.id).style.height=a.zone.height+"px";var c=document.getElementById(a.id);0.01!=a.zone.left&&(c.style.left=a.zone.left+"px");b.hDisplacement=c.style.left&&""!=c.style.left?parseInt(c.style.left.substring(0,c.style.left.length-2))+(parseInt(a.banner.left)||0):parseInt(a.banner.left)||0;e.events.emit("zoneSizeUpdate",b)});e.events.listen(e.events.eventType.frameLoaded,function(a){var b=e.zone.getZone(a.element.getAttribute("data-pid"));a.first?(b.stopObserve(),b.frameBusted=
1<a.element.parentNode.children.length,b.frameBusted&&b.observe(a.element.parentNode),b.isOverlay&&(b.isOverlay.replacer?(b.isOverlay.started=!0,b.isOverlay.checkView()):b.isOverlay.show()),"function"==typeof a.cb&&a.cb()):!b.frameBusted&&1<a.element.parentNode.children.length&&(b.frameBusted=!0,b.observe(a.element.parentNode))});var oc=function(a){a.attachEvent&&(a.attachEvent("onpropertychange",nc),a.setAttribute("hasHandler","1"));for(var b=0;b<a.childNodes.length;b++)oc(a.childNodes[b])},pc=function(a){a.getAttribute&&
a.getAttribute("hasHandler")&&(a.removeAttribute("hasHandler"),a.detachEvent("onpropertychange",nc));for(var b=0;b<a.childNodes.length;b++)pc(a.childNodes[b])},y=e.zone.getPrototype();y.rotations=0;y.displayTrackingHnd=null;y.fetchingBanner=!1;y.autoUpdateOn=!1;y.autoUpdateQueueOn=!1;y.updateCount=0;y.bannerEnteredView=!1;y.bannerInViewMessage=null;y.queue=null;y.categories=null;y.bannerTimer=null;y.processingBanner=!1;y.bitPayload=null;y.calculateVisibleTime=function(a){return this.visibleTime+((a||
+new Date)-this.bannerTimer.startTime())};y.calculateZoneVisibleTime=function(a){return this.zoneVisibleTime+((a||+new Date)-this.zoneTimer.startTime())};y.calculatePartialVisibleTime=function(a){return(a||+new Date)-this.bannerTimer.startTime()};y.calculatePartialZoneVisibleTime=function(a){return(a||+new Date)-this.zoneTimer.startTime()};y.initDisplayZone=function(){for(var a,b=0;b<this.element.childNodes.length;b++){var c=this.element.childNodes[b].tagName;c&&"SCRIPT"!=c&&(a=b)}this.fp?this.nextBanner({campaignId:this.campaignId}):
this.queue.add(this.bannerEntry.create({bannerId:this.bannerId,campaignId:this.campaignId||0,html:this.element.innerHTML,displayTime:this.displayTime,gtsTrackerUrl:this.gtsTrackerUrl,node:a}),null,!0);this.queue.dump("initial queue dump")};y.bannerFetched=function(a){this.log("banner fetched for zone "+this.id);var b;null==(b=this.queue.get(a.entryId))?this.log("entry not found with index: "+a.entryId):a.entryId<this.queue.index()?this.log("entry index is less than current queue index"):b.fetchingBanner?
(b.retriesHnd&&(this.log("clear entry.retriesHnd: "+b.retriesHnd),clearTimeout(b.retriesHnd)),b.requestEndTs=a.created,b.requestDurationMs=b.requestEndTs-b.requestBeginTs,this.bannerEntry.extend(b,a,!b.forceEntryOptions),this.log("updated entry from banner fetched:"+b),b.bannerUpdatePending?(this.nextBanner(null,b,function(){b.fetchingBanner=!1}),b.bannerUpdatePending=!1):b.fetchingBanner=!1):this.log("entry not fetching banner:"+b.toString())};y.isFetchingCurrentBanner=function(){return this.queue.getCurrent().fetchingBanner};
y.nextBanner=function(a,b,c){if(!this.locked){var d=this;this.processingBanner=!0;b||(b=this.queue.getNext());null==b&&(this.log("queue empty"),b=this.bannerEntry.create({zoneId:this.id}),this.bannerEntry.extend(b,a),this.queue.add(b,null,!0),b.bannerUpdatePending=!0);if(b.html)b.oneUpdate&&this.decOneUpdate(),a=function(){c&&c();d.processingBanner=!1},!bc||-1<cc.indexOf(this.id)||this.currView||this.isOverlay&&this.isOverlay.toggled||this.decoratorStickyBanner&&this.decoratorStickyBanner.checkCampaign(b.campaignId)?
this.updateBanner(b,a):(this.isOverlay&&this.isOverlay.show(),this.updateOnView={entry:b,cb:a});else{if(b.fetchingBanner){this.throttlingBannerUpdate=!0;this.log("enable throttling banner update in zone "+this.id);var g=this;setTimeout(function(){g.throttlingBannerUpdate=!1;g.log("disable throttling banner update in zone "+g.id)},5E3)}else kc(this,b);this.processingBanner=!1;c&&c()}}};y.updateBanner=function(a,b){this.log("updatebanner "+this);var c=this.queue.getPrevious(),d=this.queue.getCurrent(),
d=this.bannerEntry.extend(d,a),g=this,f=d,h=function(){var e=g.updateBannerEnd(c,d);c&&(c.visibleTime=e.visibleTime,c.partialVisibleTime=e.partialVisibleTime);for(e=g.element.childNodes.length-1;-1<e;e--){var f=g.element.childNodes[e],h=1==f.nodeType?f.getAttribute("class"):null;1==f.nodeType&&("SCRIPT"!=f.nodeName&&!(h&&-1<h.split(" ").indexOf("wsOverlay")))&&(!f.getAttribute("visibid")&&c&&f.setAttribute("visibid",c.visibId),fc?"none"!=f.style.display&&f.getAttribute("visibid")!=d.visibId&&f.parentNode.removeChild(f):
"none"!=f.style.display&&f.getAttribute("visibid")!=d.visibId?f.style?"none"!=f.style.display&&(f.style.display="none"):f.setAttribute("style","display:none"):f.getAttribute("visibid")==d.visibId&&(f.style.display="block"))}"r"==a.mode&&(e=g.bannerEntry.clone(c),"undefined"!=typeof e.mode&&delete e.mode,g.incOneUpdate(),e.oneUpdate=!0,g.queue.addToHead(e));"function"==typeof b&&b()};v.log("setContentFrame");var j="<html><head></head><body style='margin:0px;overflow:hidden'><script>function start(firstpass) {app.core.events.emit('frameLoaded', {element: window.frameElement, first: firstpass})};var starter = setInterval(function(){if(window.app){clearInterval(starter);start(true);setTimeout(function(){start(false)},2000);}},1000);"+
f.html+"<\/script></body></html>";if(f.node||0==f.node)for(j=0;j<this.element.childNodes.length;j++){var k=this.element.childNodes[j];1==k.nodeType&&("SCRIPT"!=k.nodeName&&k.hasAttribute("visibid")&&k.getAttribute("visibid")==f.visibId)&&(k.style.display="block")}else{k=document.createElement("div");k.style.position="relative";k.setAttribute("visibid",f.visibId);var n=document.createElement("iframe");n.style.border="none";n.id="bannerframe"+f.bannerId+ +new Date;n.async="true";n.frameBorder="no";
n.style.overflow="visible";n.style.position="relative";n.style.zIndex=1E3;n.style.left="0px";n.style.top="0px";n.style.height=r.matchRegex(f.html,r.buildRegex(e.globalParameters.attBannerHeight),1)+"px";n.style.width=r.matchRegex(f.html,r.buildRegex(e.globalParameters.attBannerWidth),1)+"px";k.style.display="none";n.setAttribute("data-pid",this.id);n.src="about:blank";k.appendChild(n);this.element.appendChild(k);for(f.node=0;null!=(k=k.previousSibling);)f.node++;n.contentWindow.contents=j;n.src='javascript:window["contents"]';
window.attachEvent?n.onreadystatechange=function(){n.contentWindow.app||(n.contentWindow.app=m,n.contentWindow.cb=h)}:n.addEventListener("load",function(){n.contentWindow.app=m;n.contentWindow.cb=h});j=n.contentWindow.location.href;-1==navigator.userAgent.indexOf("Firefox")&&"#"==j.charAt(j.length-1)&&n.contentWindow.location.replace(j+"null");this.wsOwner=!0;this.overlayData&&this.overlayData.addEntry(new Date(parseInt(f.visibId.substring(0,f.visibId.length-3))))}"function"==typeof h&&h()};y.updateBannerEnd=
function(a,b){var c=+new Date,d=this.calculatePartialVisibleTime(c),g=this.setVisibleTime(d);this.bannerTimer.stop(c);this.bannerTimer.start(c);this.bannerId=b.bannerId;this.campaignId=b.campaignId;this.impressionId=b.impressionId||0;this.displayTime=b.displayTime;this.visibleTime=b.visibleTime||0;this.remnant=b.remnant;this.log("updated zone "+this+" with banner data: "+JSON.stringify(b));this.currView&&(e.events.emit(e.events.eventType.bannerOut,this,a),this.bannerEnteredView=!0,e.events.emit(e.events.eventType.bannerInTentative,
this,b));e.events.emit(e.events.eventType.bannerPrint,this,{timeStamp:c});return{partialVisibleTime:d,visibleTime:g}};y.updateBannerMarkup=function(a){this.element.innerHTML=a};y.incOneUpdate=function(){this.updateCount+=1};y.decOneUpdate=function(){this.updateCount-=1};y.changeBanner=function(a){this.log("changebanner :"+this);a.zoneId=this.id;a=this.bannerEntry.create(a);a.bannerUpdatePending=!0;this.queue.addToHead(a);this.nextBanner()};y.addBanner=function(a){var b=this.bannerEntry.create(a);
this.queue.add(b);a.fetchBanner&&kc(this,b)};y.bannerEntry=new function(){this.create=function(a){var b={toString:function(){return JSON.stringify(this)}},b=this.extend(b,a);b.visibId=+new Date+""+Math.floor(1E3*Math.random());return b};this.extend=function(a,b,c){"undefined"==typeof c&&(c=!0);for(var d in b)if(null!=b[d]&&(c||"undefined"==typeof a[d]))a[d]=b[d];return a};this.clone=function(a){return this.extend({},a)};this.dummy=function(){return this.create({id:0,html:"<dummy/>",displayTime:0})}};
y.setCategoriesHint=function(a){this.categories=null==a?[]:"string"===typeof a?[].push(a):a};var nc=function(){r&&r.sendViewportState()};y.observe=function(a){window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver?(this.observer||(this.observer=new (window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver)(function(){r&&r.sendViewportState()})),this.observer.observe(a,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["style"]})):a.attachEvent&&
oc(a)};y.stopObserve=function(){this.frameBusted&&(this.observer?this.observer.disconnect():this.element.attachEvent&&pc(this.element))};e.extension.add("tracking.upgradeFromTentativeView",function(a){v.log("upgradeFromTentativeView: "+a);a.bannerEnteredView&&(a.bannerEnteredView=!1,e.events.emit(e.events.eventType.bannerIn,{zone:a,bannerId:a.bannerId}))});e.extension.add("tracking.inTentativeView",function(a,b){return b||a.bannerEnteredView});e.extension.add("core.zone.start",function(){this.initDisplayZone();
this.log("startDisplay")});e.extension.add("core.zone.del",function(a){this.currView&&(a=this.bannerTimer.stop(a),this.setVisibleTime(a),e.events.emit(e.events.eventType.bannerOut,this,{inTentativeView:this.bannerEnteredView,visibleTime:a}));clearInterval(this.displayTrackingHnd);this.log("delDisplay")});e.extension.add("core.zone.getdata",function(a){a.bannersQueue={};a.bannersQueue.queue=this.queue.getData();a.bannersQueue.currentIndex=this.queue.index();return a});e.extension.add("tracking.intoview",
function(a){this.bannerTimer.start(a.timeStamp);this.bannerEnteredView=!0;e.events.emit(e.events.eventType.bannerInTentative,this,a)});e.extension.add("tracking.outofview",function(a){var b=this.bannerTimer.stop(a.timeStamp);this.setVisibleTime(b);this.bannerEnteredView=!1;e.events.emit(e.events.eventType.bannerOut,this,a)});e.extension.add("core.zone.tostring",function(a,b){b.fetchingBanner=a.fetchingBanner;b.autoUpdateOn=a.autoUpdateOn;b.autoUpdateQueueOn=a.autoUpdateQueueOn;b.updateCount=a.updateCount;
b.bannerEnteredView=a.bannerEnteredView;b.bannerTimer=JSON.stringify(a.bannerTimer.toJSON());return b});e.extension.add("core.zone.init",function(){var a=this;this.updateCount=0;this.displayTime=$b;this.bannerTimer=new e.util.PartialTimer;this.queue=new function(a){var c=[],d=-1;this.clear=function(){c=[]};this.dump=function(e){var f=c.length;e&&a.log(e+"\n");a.log("banner's queue dump (size:"+f+", index:"+d+"):\n");for(e=0;e<f;e++)a.log((e===d?">>>":"")+" ("+e+"): "+c[e]+"\n");a.log("found "+f+" entries in queue")};
this.index=function(){return d};this.get=function(a){return c[a]};this.add=function(a,b,e){b?c.splice(b,0,a):c.push(a);a.index=b?b:c.length-1;e&&(d+=1)};this.addToHead=function(a){var b=d+1;this.add(a,b);a.index=b};this.getCurrent=function(){return c[d]};this.setCurrent=function(a){c[d]=a};this.getNext=function(){return d+1<c.length?(d+=1,c[d]):null};this.getPrevious=function(){return c[d-1]};this.setPrevious=function(a){c[d-1]=a};this.isEmpty=function(){return 0==c.length};this.isQueueEmpty=function(){return d+
1==c.length};this.getData=function(){return c}}(this);Zb&&(this.displayTrackingHnd=setInterval(function(){xa.signal(a)},10));this.log("initDisplay")});e.register("display",v,{});var ha={},I=m.core,qc,t,rc,ya=[],za=[],F,ib=!0;I.register("analyticszones",ha,{});var Jd=function(){for(var a={},b=0;b<arguments.length;b++){var c=arguments[b],d;for(d in c)a[d]=c[d]}return a},sc=function(a){var b;b=void 0;b={threshold:0};if(b=!(I.util.viewport.width()+I.util.viewport.scrollLeft()<=a.left-b.threshold)&&!(I.util.viewport.scrollLeft()>=
a.left+a.width-b.threshold)&&!(I.util.viewport.height()+I.util.viewport.scrollTop()<=a.top-b.threshold)&&!(I.util.viewport.scrollTop()>=a.top+a.height-b.threshold)){var c=a.width,d=a.height,e=a.top,f=a.left,h=I.util.viewport.scrollLeft(),j=I.util.viewport.scrollTop(),k=I.util.viewport.height(),n=I.util.viewport.width(),n=h+n,k=j+k,l=0,m=l=0;e>=j&&e+d<=k&&f>=h&&f+c<=n?l=100:e+d<j||e>k||f+c<h||f>n?l=0:(e>=j&&e+d<=k?l=d:e<j?l=e+d-j:e<k&&(l=k-e),f>=h&&f+c<=n?m=c:f<h?m=f+c-h:f<n&&(m=n-f),l=Math.round(100*
(l*m/(d*c))));a.visiblePercentage=l}return b},Kd=function(a,b){var c=Math.round(16777215*Math.random());switch(a){case "hex":return("#0"+c.toString(16)).replace(/^#0([0-9a-f]{6})$/i,"#$1");case "rgb":return"rgb("+(c>>16)+","+(c>>8&255)+","+(c&255)+")";case "rgba":return"rgba("+(c>>16)+","+(c>>8&255)+","+(c&255)+","+b+")";default:return c}},tc=function(){var a=(new Date).getTime();ya=[];za=[];F.style.zIndex=t.zIndex;var b=t.zoneHeight+"px";I.util.viewport.width();I.util.viewport.height();for(var c=
Math.max(Math.max(document.body.scrollHeight,document.documentElement.scrollHeight),Math.max(document.body.offsetHeight,document.documentElement.offsetHeight),Math.max(document.body.clientHeight,document.documentElement.clientHeight)),d=Math.max(Math.max(document.body.scrollWidth,document.documentElement.scrollWidth),Math.max(document.body.offsetWidth,document.documentElement.offsetWidth),Math.max(document.body.clientWidth,document.documentElement.clientWidth)),e;F.hasChildNodes();)F.removeChild(F.lastChild);
if(t.viewport)if("object"!=typeof t.viewport){e=document.getElementById(t.viewport);for(var d=e.offsetLeft,f=e;f.parentNode&&"BODY"!=f.parentNode.nodeName.toUpperCase();)f=f.parentNode,d+=f.offsetLeft;F.style.position="absolute";F.style.top="0px";F.style.display="block";F.style.height=c+"px";e=I.util.DOM.getElementCss(e).width;F.style.width=e;F.style.left=d+"px";e=parseInt(e.substring(0,e.indexOf("p")))}else{F.style.position="absolute";F.style.top="0px";F.style.display="block";F.style.height=c+"px";
F.style.width=d+"px";for(e in t.viewport)F.style[e]=t.viewport[e];e=parseInt(F.style.width.substring(0,F.style.width.indexOf("p")))}else F.style.position="absolute",F.style.top="0px",e=d,F.style.height=c+"px",F.style.width=e+"px";t.drawZonesonScreen&&document.body.appendChild(F);"auto"==t.numColsType?(t.numCols=Math.floor(e/t.zoneWidth),d=t.zoneWidth+"px"):(d=Math.floor(e/t.numCols)+"px",t.zoneWidth=Math.floor(e/t.numCols));e=t.numCols;for(var c=Math.floor(c/t.zoneHeight)+1,h=f=0,j=0,k=0;k<c;k++){for(var l=
0;l<e;l++){var m={id:f,top:h,left:j,width:t.zoneWidth,height:t.zoneHeight,cssWidth:d,cssHeight:b,gridPosition:[],inViewport:!1,visiblePercentage:0,zonePositioningStyle:"absolute"};m.gridPosition=[l,k];ya.push(m);ha.log("new tracking zone: "+JSON.stringify(m));j+=t.zoneWidth;f++;var q=t,r=F;if("true"==q.drawZonesonScreen.toString().toLowerCase()){var s=document.createElement("div");s.id="trackerZone"+m.id;s.setAttribute("id","trackerZone"+m.id);s.style.width=m.cssWidth;s.style.height=m.cssHeight;s.style.display=
"block";s.style.position=m.zonePositioningStyle;s.style.top=m.top+"px";s.style.left=m.left+"px";s.style.zIndex=q.zIndex;s.style.backgroundColor=Kd("rgba",q.colorAlpha);r.appendChild(s)}}h+=t.zoneHeight;j=0}b=(new Date).getTime();ha.log("tracking zones generation - processing time (ms): "+parseInt(b-a))},qa,uc,vc,jb=function(a){a.focus=ib;a=Jd(t,a);clearTimeout(uc);za=[];for(var b=ya,c=0;c<b.length;c++){var d=b[c];d.inViewport=sc(d)}for(b=0;b<ya.length;b++)c=ya[b],c.inViewport=sc(c),c.inViewport&&
c.visiblePercentage>=a.zoneVisiblePercentage&&za.push(c);ha.log("# visible zones: "+za.length);b=za;a=a||{};a={trackingzoneIds:"",timestamp:a.ts||+new Date,screenWidth:screen.width,currentLocationHint:self.currentLocationHint?self.currentLocationHint:self.currentLocationHref?self.currentLocationHref:window.location.href,focus:a.focus?1:0};if(0<b.length){c=bottomright=b[0];for(d=1;d<b.length;d++){var e=b[d];e.top<=c.top&&e.left<=c.left&&(c=e);e.top>=bottomright.top&&e.left>=bottomright.left&&(bottomright=
e)}a.trackingzoneIds="gridPosition"==t.sendZoneInfoType?c.gridPosition.toString()+"-"+bottomright.gridPosition.toString():c.left+","+c.top+"-"+(bottomright.left+t.zoneWidth)+","+(bottomright.top+t.zoneHeight)}a.trackingzoneIds+="["+t.zoneWidth+"*"+t.zoneHeight+"]";rc.sendTrackingZones(a);ha.log("sent tracking zones info:"+JSON.stringify(a));uc=setTimeout(function(){jb({ts:+new Date})},vc)};qa={start:function(a){vc=t.statusInterval||1E4;a&&jb({ts:+new Date})},update:jb};ha.init=function(){rc=m.messaging;
ha.log("init analyticszones");if(qc){t=""==t?{}:JSON.parse(t);var a={};a.statusInterval=t.statusInterval||1E4;a.numColsType=t.numColsType||"fixed";a.numCols=t.numCols||10;a.zoneWidth=t.zoneWidth||100;a.zoneHeight=t.zoneHeight||100;a.sendZoneInfoType=t.sendZoneInfoType||"gridPosition";a.zIndex=t.zIndex||-1;a.drawZonesonScreen=t.drawZonesonScreen||!1;a.colorAlpha=t.colorAlpha||0.45;a.zoneVisiblePercentage=t.zoneVisiblePercentage||80;a.viewport=t.viewport;t=a;F=document.createElement("DIV");tc();qa.start(!0);
ha.log("started statusUpdater");I.events.listen(I.events.eventType.focus,function(a){ib=!0;qa.update({ts:a&&a.timeStamp?a.timeStamp:+new Date})});I.events.listen(I.events.eventType.blur,function(a){ib=!1;qa.update({ts:a&&a.timeStamp?a.timeStamp:+new Date})});I.events.listen(I.events.eventType.scroll,function(){qa.update({ts:+new Date})});I.events.listen(I.events.eventType.resize,function(){tc();qa.update({ts:+new Date})})}};qc=I.getParam("tzg","trackZonesGridOn",!1,!0);t=I.getParam("zgo","zonesGridOptions",
"");var Ma={},ia=m.core,wc,ra,xc=function(){wc||(ia.util.executeOnPredicate(function(){Ma.log("loading quantcast frame with url: "+ra);var a=document.createElement("iframe");a.setAttribute("style","display:none;width:0px;height:0px");a.id="wsqcast";a.async="true";a.src=ra+(-1<ra.indexOf("?")?"&":"?")+"cid="+encodeURIComponent(ia.globalParameters.publisherChannelId);a.frameBorder="no";document.body.appendChild(a)},function(){return document.body}),wc=!0)};Ma.init=function(){var a=ia.getParam("qlc",
"quantcastloadOnOrtcConnect",!1,!0);ra=ia.getParam("qpu","quantcastPageUrl","");if(""!=(ra=ia.util.trim(ra)))a?ia.events.listen(ia.events.eventType.ortcConnected,xc):xc();Ma.log("init")};ia.register("quantcast",Ma,{});var Na={},kb=m.core,yc,zc=function(a){if("testInit"==a.data.msg)if(a.data.publicId!=kb.globalParameters.publicId){var a=a.data.publicId,b=document.createElement("div");b.setAttribute("style","position:fixed;top:0px;z-index:100000000;width:100%;text-align:center;background-color:black;color:yellow;left:0px;font-size:20px");
b.innerHTML='Invalid application identifier found. Expected identifier is "<strong>'+a+'</strong>" but we found "<strong>'+kb.globalParameters.publicId+'</strong>" instead.';document.body.appendChild(b)}else yc.toggleOverlay(a.data.adUnits)};Na.init=function(){yc=m.tracking;Na.log("init postmessage")};Na.ready=function(){window.opener&&window.postMessage&&(window.attachEvent?window.attachEvent("onmessage",zc,!1):window.addEventListener("message",zc,!1),window.opener.postMessage("wsReady","*"))};kb.register("postmessage",
Na,{});var lb=m.core,Ld="undefined"==typeof window.WS_INIT?!0:window.WS_INIT,mb=function(){Ld&&lb.init()};lb.InitOnLoad&&(lb.InitOnPageLoad&&"complete"!=document.readyState?window.addEventListener?window.addEventListener("load",mb,!1):window.attachEvent&&window.attachEvent("onload",mb):mb())}();
